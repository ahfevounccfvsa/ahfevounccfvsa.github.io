<!DOCTYPE html>
<html lang=zh-Hans>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="null">
  <meta name="keywords" content="undefined">
  
    <link rel="icon" href="/favicon.ico">
  
    
  <title>JavaFx TableView疑难详解 | cmlanche</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/lib/jquery.fancybox.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <header>
  <div class="header-container">
    <a class='logo' href="/">
      <span>cmlanche</span>
    </a>
    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
    </ul>
  </div>
</header>

  <main id='post'>
  <div class="content">
    <article>
        <section class="content markdown-body">
          <h1>JavaFx TableView疑难详解</h1>
          <div class='post-meta'>
            <i class="fa fa-calendar" aria-hidden="true"></i> <time>2017/06/08</time>
            
            
              | 
                  <i class="fa fa-tags" aria-hidden="true"></i>
                
               
  <a href="/tags/#javafx" class='tag'>javafx</a>

  <a href="/tags/#javafx-tableview" class='tag'>javafx-tableview</a>


            
          </div>
          <p>TableView是个十分有用的控件，适应性和灵活性非常强，可以对它进行任意的修改，比如界面样式、功能。本文将从一步步提问的方式讲解TableView</p>
<a id="more"></a>
<ol>
<li><h3 id="创建已知列的TableView"><a href="#创建已知列的TableView" class="headerlink" title="创建已知列的TableView"></a>创建已知列的TableView</h3><p>已知列的表格的创建，需要把TableView的TableColumn关联到模型的属性，TableView是个模板类，其实是TableView<t>，这个T就是模型，例如下代码：</t></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="comment">// MyModel.java</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyModel</span></span>&#123;</div><div class="line">  <span class="keyword">private</span> String name;</div><div class="line">  <span class="keyword">private</span> String url;</div><div class="line">  <span class="comment">// getters, setters</span></div><div class="line">  ...</div><div class="line">&#125;</div><div class="line"><span class="comment">// init your tableView</span></div><div class="line">TableColumn&lt;MyModel, String&gt; t1 = <span class="keyword">new</span> TableColumn();</div><div class="line"><span class="comment">// 关联MyModel中的name属性</span></div><div class="line">t1.setCellValueFactory(<span class="keyword">new</span> PropertyValueFactory&lt;&gt;(<span class="string">"name"</span>)); </div><div class="line">t1.setCellFactory(p-&gt;&#123;</div><div class="line">  <span class="comment">// 创建此列的Cell的时候的回调，允许让你自己去创建</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>特别要说明的是</strong>，<code>setCellValueFactory</code>和<code>setCellFactory</code>不是冲突的，我用的时候一直以为是冲突，就是只能用其中一个，另外一个就失效了，其实不是，setCellFactory它的意图是在创建这列的时候要做的事情，你可以改变TableCell的任何内容，包括UI和Value，而setCellValueFactory呢，它的重点是关联属性，从你传递给它的Model中通过对应属性的getter来获取值。在setCellFactory中的TableCell有个回调，叫<code>updateItem</code>，它可以获取到你设置到此Cell的值，这个值是跟setCellValueFactory所关联的属性有关。</p>
</li>
<li><h3 id="创建动态列的TableView"><a href="#创建动态列的TableView" class="headerlink" title="创建动态列的TableView"></a>创建动态列的TableView</h3><p>参考：<a href="https://community.oracle.com/thread/2474328" target="_blank" rel="external">https://community.oracle.com/thread/2474328</a></p>
<p>因为列是不定的，模型是没有属性对应的，创建列的时候你根本不知道列是什么，看如下实现代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">column.setCellValueFactory(param -&gt; &#123;</div><div class="line">            ObservableList&lt;VarCell&gt; values = param.getValue();</div><div class="line">            <span class="keyword">if</span> (columnIndex &gt;= values.size()) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SimpleObjectProperty&lt;&gt;(<span class="keyword">null</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SimpleObjectProperty&lt;&gt;(param.getValue().get(columnIndex));</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<p>创建动态列的tableview，它的模型是一个<code>ObservableList&lt;T&gt;</code>，你的<code>setCellValueFactory</code>不能使用<code>PropertyValueFactory</code>，而是如上代码所示，<strong>通过列的索引来获取此列的值</strong></p>
</li>
<li><h3 id="列拖动-如何捕获列拖动事件？"><a href="#列拖动-如何捕获列拖动事件？" class="headerlink" title="[列拖动] 如何捕获列拖动事件？"></a><strong>[列拖动]</strong> 如何捕获列拖动事件？</h3><p>列拖动是tablview一个默认的自带的效果，但是并没有专门的事件给你去监听它，而是监听列的变化，方法：给tableview的columns添加Listener,判断变动列的状态是否是replaced的状态，例如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">tableView.getColumns().addListener(<span class="keyword">new</span> ListChangeListener&lt;TableColumn&lt;ObservableList&lt;VarCell&gt;, ?&gt;&gt;() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onChanged</span><span class="params">(Change&lt;? extends TableColumn&lt;ObservableList&lt;VarCell&gt;, ?&gt;&gt; change)</span> </span>&#123;</div><div class="line">                change.next();</div><div class="line">                <span class="keyword">if</span> (change.wasReplaced()) &#123;</div><div class="line">                    <span class="comment">// 表示当前拖动过了</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
</li>
<li><h3 id="列拖动-如何防止第一列被拖动？"><a href="#列拖动-如何防止第一列被拖动？" class="headerlink" title="[列拖动] 如何防止第一列被拖动？"></a><strong>[列拖动]</strong> 如何防止第一列被拖动？</h3><p>在上一问的基础上，实现第一列不允许被拖动的功能。</p>
<p>参考：<a href="https://stackoverflow.com/questions/30645606/javafx-restrict-column-rearrangement-on-drag-and-drop" target="_blank" rel="external">https://stackoverflow.com/questions/30645606/javafx-restrict-column-rearrangement-on-drag-and-drop</a></p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">tableView.getColumns().addListener(<span class="keyword">new</span> ListChangeListener&lt;TableColumn&lt;ObservableList&lt;String&gt;, ?&gt;&gt;() &#123;</div><div class="line">            <span class="keyword">private</span> <span class="keyword">boolean</span> suspended;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onChanged</span><span class="params">(Change&lt;? extends TableColumn&lt;ObservableList&lt;String&gt;, ?&gt;&gt; change)</span> </span>&#123;</div><div class="line">                change.next();</div><div class="line"></div><div class="line">                <span class="keyword">if</span> (change.wasReplaced() &amp;&amp; !suspended) &#123;</div><div class="line">                    List&lt;TableColumn&lt;ObservableList&lt;String&gt;, ?&gt;&gt; oldList = <span class="keyword">new</span> ArrayList&lt;&gt;(change.getRemoved());</div><div class="line">                    List&lt;TableColumn&lt;ObservableList&lt;String&gt;, ?&gt;&gt; newList = <span class="keyword">new</span> ArrayList&lt;&gt;(tableView.getColumns());</div><div class="line"></div><div class="line">                    <span class="comment">// first column changed =&gt; revert to original list</span></div><div class="line">                    <span class="keyword">if</span> (oldList.get(<span class="number">0</span>) != newList.get(<span class="number">0</span>)) &#123;</div><div class="line">                        <span class="keyword">this</span>.suspended = <span class="keyword">true</span>;</div><div class="line">                        tableView.getColumns().setAll(oldList);</div><div class="line">                        <span class="keyword">this</span>.suspended = <span class="keyword">false</span>;</div><div class="line">                    &#125; </div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<p>上面的代码中有三个关键的地方，是tableview原本提供的api，一个是<code>change.wasReplaced</code>表示当前的变动是否被替换了，第二个是<code>change.getRemoved</code>，表示获取要移除掉的列，进一步的意思就是原来的列，也就是此前的tablecolumns，第三个是<code>tableview.getColumns</code>这个是获取现在列，有了这些信息，就可以判断，<code>oldList.get(0)!=newList(0)</code>，表示如果新老列的第一列不相同，表示是第一列是变动的，但是我们不允许变动，因此，调用<code>tableview.getColumns().setAll(oldList)</code>用来恢复原来的列。这样就禁止拖动第一列了。</p>
</li>
<li><h3 id="列拖动-如何禁用列拖动效果？"><a href="#列拖动-如何禁用列拖动效果？" class="headerlink" title="[列拖动] 如何禁用列拖动效果？"></a><strong>[列拖动]</strong> 如何禁用列拖动效果？</h3><p>参考：<a href="https://stackoverflow.com/questions/22202782/how-to-prevent-tableview-from-doing-tablecolumn-re-order-in-javafx-8" target="_blank" rel="external">https://stackoverflow.com/questions/22202782/how-to-prevent-tableview-from-doing-tablecolumn-re-order-in-javafx-8</a></p>
<p>给列设置一个属性：<code>column.impl_setReorderable(false);</code></p>
<p><code>impl_setReorderable</code>前面带<strong>impl_</strong>前缀，表示它是一个将来可能会被删除的方法，但是为了解决目前无法解决的问题，暂时把impl的私有方法改为了public方法，参考我的博客中的如何<a href="http://cmlanche.com/2017/05/02/JavaFx%E8%87%AA%E5%AE%9A%E4%B9%89Tab%20Order/" target="_blank" rel="external">自定义Taborder</a>的文章，是一样的道理。</p>
</li>
<li><h3 id="行拖动-如何拖动行，进行换行？"><a href="#行拖动-如何拖动行，进行换行？" class="headerlink" title="[行拖动] 如何拖动行，进行换行？"></a><strong>[行拖动]</strong> 如何拖动行，进行换行？</h3><p>参考：<a href="https://stackoverflow.com/questions/28603224/sort-tableview-with-drag-and-drop-rows" target="_blank" rel="external">https://stackoverflow.com/questions/28603224/sort-tableview-with-drag-and-drop-rows</a></p>
<p>已经测试过的代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">tableView.setRowFactory(tv -&gt; &#123;</div><div class="line">            TableRow&lt;ObservableList&lt;String&gt;&gt; row = <span class="keyword">new</span> TableRow&lt;&gt;();</div><div class="line"></div><div class="line">            row.setOnDragDetected(event -&gt; &#123;</div><div class="line">                log.info(<span class="string">"row drag detected"</span>);</div><div class="line">                <span class="keyword">if</span> (!row.isEmpty()) &#123;</div><div class="line">                    Integer index = row.getIndex();</div><div class="line">                    Dragboard db = row.startDragAndDrop(TransferMode.MOVE);</div><div class="line">                    db.setDragView(row.snapshot(<span class="keyword">null</span>, <span class="keyword">null</span>));</div><div class="line">                    ClipboardContent cc = <span class="keyword">new</span> ClipboardContent();</div><div class="line">                    cc.put(SERIALIZED_MIME_TYPE, index);</div><div class="line">                    db.setContent(cc);</div><div class="line">                    event.consume();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            row.setOnDragOver(event -&gt; &#123;</div><div class="line">                log.info(<span class="string">"row drag over"</span>);</div><div class="line">                Dragboard db = event.getDragboard();</div><div class="line">                <span class="keyword">if</span> (db.hasContent(SERIALIZED_MIME_TYPE)) &#123;</div><div class="line">                    <span class="keyword">if</span> (row.getIndex() != ((Integer) db.getContent(SERIALIZED_MIME_TYPE)).intValue()) &#123;</div><div class="line">                        event.acceptTransferModes(TransferMode.COPY_OR_MOVE);</div><div class="line">                        event.consume();</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            row.setOnDragDropped(event -&gt; &#123;</div><div class="line">                log.info(<span class="string">"row drag dropped"</span>);</div><div class="line">                Dragboard db = event.getDragboard();</div><div class="line">                <span class="keyword">if</span> (db.hasContent(SERIALIZED_MIME_TYPE)) &#123;</div><div class="line">                    <span class="keyword">int</span> draggedIndex = (Integer) db.getContent(SERIALIZED_MIME_TYPE);</div><div class="line">                    ObservableList&lt;String&gt; draggedPerson = tableView.getItems().remove(draggedIndex);</div><div class="line"></div><div class="line">                    <span class="keyword">int</span> dropIndex;</div><div class="line"></div><div class="line">                    <span class="keyword">if</span> (row.isEmpty()) &#123;</div><div class="line">                        dropIndex = tableView.getItems().size();</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        dropIndex = row.getIndex();</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    tableView.getItems().add(dropIndex, draggedPerson);</div><div class="line"></div><div class="line">                    event.setDropCompleted(<span class="keyword">true</span>);</div><div class="line">                    tableView.getSelectionModel().select(dropIndex);</div><div class="line">                    event.consume();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            <span class="keyword">return</span> row;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
</li>
<li><h3 id="修改TableView样式"><a href="#修改TableView样式" class="headerlink" title="修改TableView样式"></a>修改TableView样式</h3><p>使用css，参考如下我的测试代码</p>
<figure class="highlight css"><table><tr><td class="code"><pre><div class="line"><span class="selector-class">.table-view</span> &#123;</div><div class="line">    <span class="attribute">-fx-border-width</span>: <span class="number">1px</span>;</div><div class="line">    <span class="attribute">-fx-border-color</span>: <span class="number">#CACACA</span>;</div><div class="line">    <span class="attribute">-fx-background-color</span>: transparent;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span><span class="selector-pseudo">:focused</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: transparent;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.table-cell</span> &#123;</div><div class="line">    <span class="attribute">-fx-font-size</span>: <span class="number">12px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.filler</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: <span class="number">#BDE8FF</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.text</span> &#123;</div><div class="line">    <span class="attribute">-fx-text-fill</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.column-header</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: <span class="number">#BDE8FF</span>;</div><div class="line">    <span class="attribute">-fx-pref-height</span>: <span class="number">37px</span>;</div><div class="line">    <span class="attribute">-fx-border-width</span>: <span class="number">1px</span>;</div><div class="line">    <span class="attribute">-fx-border-color</span>: <span class="number">#D9D9D9</span>;</div><div class="line">    <span class="attribute">-fx-border-insets</span>: -<span class="number">2px</span> -<span class="number">2px</span> <span class="number">0px</span> -<span class="number">2px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.column-header-background</span> <span class="selector-class">.label</span> &#123;</div><div class="line">    <span class="attribute">-fx-text-fill</span>: <span class="number">#363739</span>;</div><div class="line">    <span class="attribute">-fx-font-weight</span>: normal;</div><div class="line">    <span class="attribute">-fx-font-size</span>: <span class="number">12px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-row-cell</span> &#123;</div><div class="line">    <span class="comment">/*行高*/</span></div><div class="line">    <span class="attribute">-fx-cell-size</span>: <span class="number">35px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-row-cell</span> <span class="selector-class">.cell</span> &#123;</div><div class="line">    <span class="attribute">-fx-alignment</span>: center;</div><div class="line">    <span class="attribute">-fx-text-fill</span>: <span class="number">#333333</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.table-cell</span><span class="selector-pseudo">:selected</span> &#123;</div><div class="line">    <span class="attribute">-fx-text-fill</span>: white;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.table-column</span> <span class="selector-class">.column-header</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: <span class="number">#363739</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.cell</span> &#123;</div><div class="line">    <span class="comment">/*-fx-border-width: 0px 1px 0 0;*/</span></div><div class="line">    <span class="comment">/*-fx-border-color: #CACACA;*/</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.table-view</span> <span class="selector-class">.scroll-bar</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: transparent;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.viewport</span> &#123;</div><div class="line">    <span class="attribute">-fx-background-color</span>: white;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><h3 id="如何自定义列头，比如自己设置一个可编辑的列头呢？"><a href="#如何自定义列头，比如自己设置一个可编辑的列头呢？" class="headerlink" title="如何自定义列头，比如自己设置一个可编辑的列头呢？"></a>如何自定义列头，比如自己设置一个可编辑的列头呢？</h3><p>答案是给你的TableColumn设置<code>setGraphic</code>，可编辑的列头的话，你让你的graphic中有编辑框，双击显示编辑框，按enter键确认编辑，如下是一个我的实现：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="keyword">package</span> com.itestin.ui.datamgt.table;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.itestin.ui.recordNreplay.logic.CommonLogic;</div><div class="line"><span class="keyword">import</span> javafx.beans.property.BooleanProperty;</div><div class="line"><span class="keyword">import</span> javafx.beans.property.SimpleBooleanProperty;</div><div class="line"><span class="keyword">import</span> javafx.beans.property.SimpleStringProperty;</div><div class="line"><span class="keyword">import</span> javafx.beans.property.StringProperty;</div><div class="line"><span class="keyword">import</span> javafx.geometry.Pos;</div><div class="line"><span class="keyword">import</span> javafx.scene.control.Label;</div><div class="line"><span class="keyword">import</span> javafx.scene.control.TableColumn;</div><div class="line"><span class="keyword">import</span> javafx.scene.control.TextField;</div><div class="line"><span class="keyword">import</span> javafx.scene.control.Tooltip;</div><div class="line"><span class="keyword">import</span> javafx.scene.input.KeyCode;</div><div class="line"><span class="keyword">import</span> javafx.scene.layout.StackPane;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Created by cmlanche on 2017/6/1.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EditColumn</span> <span class="keyword">extends</span> <span class="title">StackPane</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> EditColumnCallback callback;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> Label label;</div><div class="line">    <span class="keyword">private</span> TextField textField;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> StringProperty title;</div><div class="line">    <span class="keyword">private</span> BooleanProperty editing;</div><div class="line">    <span class="keyword">private</span> BooleanProperty editable;</div><div class="line">    <span class="keyword">private</span> BooleanProperty textFieldFocus;</div><div class="line">    <span class="keyword">private</span> TableColumn tableColumn;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> String oldTitle;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EditColumn</span><span class="params">(TableColumn tableColumn)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>();</div><div class="line">        <span class="keyword">this</span>.tableColumn = tableColumn;</div><div class="line">        <span class="keyword">this</span>.init();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.setMaxWidth(<span class="number">120</span>);</div><div class="line">        <span class="keyword">this</span>.setAlignment(Pos.CENTER);</div><div class="line">        <span class="keyword">this</span>.setStyle(<span class="string">"-fx-background-color: #D9D9D9;"</span>);</div><div class="line">        label = <span class="keyword">new</span> Label();</div><div class="line">        label.setStyle(<span class="string">"-fx-font-size: 12px; -fx-text-fill: #333333;"</span>);</div><div class="line">        textField = <span class="keyword">new</span> TextField();</div><div class="line">        textField.getStyleClass().add(<span class="string">"tablefx-header-editor"</span>);</div><div class="line">        label.textProperty().bindBidirectional(titleProperty());</div><div class="line">        textField.textProperty().bindBidirectional(titleProperty());</div><div class="line">        label.setTooltip(<span class="keyword">new</span> Tooltip());</div><div class="line">        label.getTooltip().textProperty().bindBidirectional(label.textProperty());</div><div class="line">        <span class="keyword">this</span>.getChildren().addAll(label, textField);</div><div class="line">        editingProperty().addListener((observable, oldValue, newValue) -&gt; &#123;</div><div class="line">            <span class="keyword">if</span> (isEditable()) &#123;</div><div class="line">                <span class="keyword">if</span> (newValue) &#123;</div><div class="line">                    label.setVisible(<span class="keyword">false</span>);</div><div class="line">                    textField.setVisible(<span class="keyword">true</span>);</div><div class="line">                    textField.setFocusTraversable(<span class="keyword">true</span>);</div><div class="line">                    textField.requestFocus();</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    label.setVisible(<span class="keyword">true</span>);</div><div class="line">                    textField.setVisible(<span class="keyword">false</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        textField.textProperty().addListener((observable, oldValue, newValue) -&gt; &#123;</div><div class="line">            textField.setStyle(<span class="string">"-fx-border-color: #25B3FA;"</span>);</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">this</span>.setStyle(<span class="string">"-fx-background-color: transparent;"</span>);</div><div class="line">        textField.setOnKeyPressed(event -&gt; &#123;</div><div class="line">            <span class="keyword">if</span> (isEditing()) &#123;</div><div class="line">                <span class="keyword">if</span> (event.getCode() == KeyCode.ENTER) &#123;</div><div class="line">                    event.consume(); <span class="comment">// 放置对tabview的其他列产生影响，不让消息透传</span></div><div class="line">                    oldTitle = textField.getText();</div><div class="line">                    setEditing(<span class="keyword">false</span>);</div><div class="line">                    <span class="comment">// 提交编辑</span></div><div class="line">                    <span class="keyword">if</span> (callback != <span class="keyword">null</span>) &#123;</div><div class="line">                        callback.editCommit(tableColumn, textField.getText());</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.getCode() == KeyCode.ESCAPE) &#123;</div><div class="line">                    setTitle(oldTitle);</div><div class="line">                    setEditing(<span class="keyword">false</span>);</div><div class="line">                    <span class="comment">// 取消编辑</span></div><div class="line">                    <span class="keyword">if</span> (callback != <span class="keyword">null</span>) &#123;</div><div class="line">                        callback.cancelEdit();</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (event.getCode() == KeyCode.TAB) &#123;</div><div class="line">                    setEditing(<span class="keyword">false</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        textFieldFocusProperty().addListener((observable, oldValue, newValue) -&gt; &#123;</div><div class="line">            <span class="keyword">if</span> (newValue) &#123;</div><div class="line">                textField.setFocusTraversable(<span class="keyword">true</span>);</div><div class="line">                textField.requestFocus();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        setEditing(<span class="keyword">false</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> titleProperty().get();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> StringProperty <span class="title">titleProperty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (title == <span class="keyword">null</span>) &#123;</div><div class="line">            title = <span class="keyword">new</span> SimpleStringProperty();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> title;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.oldTitle = title;</div><div class="line">        <span class="keyword">this</span>.titleProperty().set(title);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEditing</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> editingProperty().get();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> BooleanProperty <span class="title">editingProperty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (editing == <span class="keyword">null</span>) &#123;</div><div class="line">            editing = <span class="keyword">new</span> SimpleBooleanProperty(<span class="keyword">true</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> editing;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEditing</span><span class="params">(<span class="keyword">boolean</span> editing)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.editingProperty().set(editing);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEditCallback</span><span class="params">(EditColumnCallback callback)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.callback = callback;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEditable</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> editableProperty().get();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> BooleanProperty <span class="title">editableProperty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (editable == <span class="keyword">null</span>) &#123;</div><div class="line">            editable = <span class="keyword">new</span> SimpleBooleanProperty(<span class="keyword">true</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> editable;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEditable</span><span class="params">(<span class="keyword">boolean</span> editable)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.editableProperty().set(editable);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isTextFieldFocus</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> textFieldFocusProperty().get();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> BooleanProperty <span class="title">textFieldFocusProperty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (textFieldFocus == <span class="keyword">null</span>) &#123;</div><div class="line">            textFieldFocus = <span class="keyword">new</span> SimpleBooleanProperty();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> textFieldFocus;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTextFieldFocus</span><span class="params">(<span class="keyword">boolean</span> textFieldFocus)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.textFieldFocusProperty().set(textFieldFocus);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ol>
<h3 id="最后欢迎加入我的javafx探讨群：518914410"><a href="#最后欢迎加入我的javafx探讨群：518914410" class="headerlink" title="最后欢迎加入我的javafx探讨群：518914410"></a>最后欢迎加入我的javafx探讨群：<code>518914410</code></h3><p>本文版权原创 by <a href="cmlanche.com">cmlanche.com</a></p>

        </section>
    </article>
    
        <!-- disqus 评论框 start -->
        <div class="comment">
            <div id="disqus_thread" class="disqus-thread">
              <i>Loading comments box needs to over the wall</i>
            </div>
        </div>
        <!-- disqus 评论框 end -->
    
    
        <!-- livere 评论框 start -->
        <div class="comment">
            <div id="lv-container" data-id="city" data-uid="your_livere_uid"></div>
        </div>
        <!-- livere 评论框 end -->
        
  </div>
  <aside>
    
    <div class="toc-container">
        <h1>目录</h1>
        <div class="content">
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建已知列的TableView"><span class="toc-number">1.</span> <span class="toc-text">创建已知列的TableView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建动态列的TableView"><span class="toc-number">2.</span> <span class="toc-text">创建动态列的TableView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列拖动-如何捕获列拖动事件？"><span class="toc-number">3.</span> <span class="toc-text">[列拖动] 如何捕获列拖动事件？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列拖动-如何防止第一列被拖动？"><span class="toc-number">4.</span> <span class="toc-text">[列拖动] 如何防止第一列被拖动？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#列拖动-如何禁用列拖动效果？"><span class="toc-number">5.</span> <span class="toc-text">[列拖动] 如何禁用列拖动效果？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#行拖动-如何拖动行，进行换行？"><span class="toc-number">6.</span> <span class="toc-text">[行拖动] 如何拖动行，进行换行？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改TableView样式"><span class="toc-number">7.</span> <span class="toc-text">修改TableView样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何自定义列头，比如自己设置一个可编辑的列头呢？"><span class="toc-number">8.</span> <span class="toc-text">如何自定义列头，比如自己设置一个可编辑的列头呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最后欢迎加入我的javafx探讨群：518914410"><span class="toc-number">9.</span> <span class="toc-text">最后欢迎加入我的javafx探讨群：518914410</span></a></li></ol>
        </div>
    </div>
    
  </aside>
</main>

<!-- disqus 公共JS代码 -->
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES * * */
  var disqus_shortname = "your_disqus_shortname";
  var disqus_identifier = "http://www.cmlanche.com/2017/06/08/JavaFx-TableView详解/";
  var disqus_url = "http://www.cmlanche.com/2017/06/08/JavaFx-TableView详解/";

  isAgent(getDisqus)

  // determine user agent in China
  function isAgent(cb) {
    var url = '//graph.facebook.com/feed?callback=h';
    var xhr = new XMLHttpRequest();
    var called = false;
    xhr.open('GET', url);
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4 && xhr.status === 200) {
      called = true;
      cb(true);
      }
    };
    xhr.send();
    // timeout 1s, this facebook API is very fast.
    setTimeout(function() {
      if (!called) {
      xhr.abort();
      cb(false)
      }
    }, 1000);
  }

  function getDisqus(isAgent) {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; 
    dsq.async = true
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq)
  }
</script>
<!-- disqus 公共JS代码 end -->


<script type="text/javascript">
  (function(d, s) {
      var j, e = d.getElementsByTagName(s)[0];

      if (typeof LivereTower === 'function') { return; }

      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;

      e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>


  <footer>
  <div class="copyright">
    <div>
      &copy; 2018 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a>&nbsp
    </div>
    <div>
      Theme by <a href="https://github.com/lewis-geek/hexo-theme-Aath" target="_blank">Aath</a>
    </div>
  </div>
</footer>


<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="/lib/in-view.min.js"></script>
<script src="/lib/lodash.min.js"></script>
<script>
  var isDown = true
  var oldY = 0
  inView.offset(50)

  document.body.addEventListener('touchstart', function(){});
  
  window.addEventListener('scroll', _.throttle(e => {
    var currentY = window.scrollY
    if((oldY - currentY) < 0) {
      isDown = true
    } else {
      isDown = false
    }
    oldY = currentY
  }, 250))

  $("article img").each(function() {
      var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
      $(this).wrapAll(strA);
  });

  $('.toc-link').each(function() {
      var href = $(this).attr("href");
      
      inView(href).on('exit', () => {
        if (isDown) {
          handleActive(href)
        }
      })

      inView(href).on('enter', () => {
        if (!isDown) {
          handleActive(href)
        }
      })

      this.onclick = function(e) {
        var pos = $(href).offset().top - 10;
        $("html,body").animate({scrollTop: pos}, 300);
        setTimeout(() => {
          handleActive(href)
        }, 350)
        return false
      }
  })

  function handleActive(href) {
    document.querySelectorAll('.toc-link').forEach(elm => {
      elm.classList.remove('active')
    })
    document.querySelector(".toc [href='"+ href +"']").classList.add('active')
  }
</script>
<script src="/lib/jquery.fancybox.min.js"></script>


</body>
</html>
