<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>cmlanche</title>
  
  <subtitle>越努力越幸运</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.cmlanche.com/"/>
  <updated>2019-07-24T09:52:23.000Z</updated>
  <id>http://www.cmlanche.com/</id>
  
  <author>
    <name>cmlanche</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>美团点评云真机平台实践</title>
    <link href="http://www.cmlanche.com/2019/07/24/%E7%BE%8E%E5%9B%A2%E7%82%B9%E8%AF%84%E4%BA%91%E7%9C%9F%E6%9C%BA%E5%B9%B3%E5%8F%B0%E5%AE%9E%E8%B7%B5/"/>
    <id>http://www.cmlanche.com/2019/07/24/美团点评云真机平台实践/</id>
    <published>2019-07-24T09:36:22.000Z</published>
    <updated>2019-07-24T09:52:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>随着美团点评业务越来越多，研发团队越来越庞大，对测试手机的需求显著增长。这对公司来说是一笔不小的开支，但现有测试手机资源分配不均，利用率也非常有限，导致各个团队开发、测试过程中都很难做到多机型覆盖。怎么样合理、高效利用这些测试手机资源，是摆在我们面前的一道难题。</p><a id="more"></a><h3 id="现有的方案"><a href="#现有的方案" class="headerlink" title="现有的方案"></a>现有的方案</h3><p>为了解决这些问题，业内也出现了一些手机管理和在线调试使用的工具或平台，比较常见的有:</p><ul><li>OpenSTF</li><li>百度MTC的远程真机调试</li><li>Testin的云真机</li><li>腾讯WeTest的云真机</li><li>阿里MQC的远程真机租用</li></ul><p>其中OpenSTF是开源项目，其他的平台大多也都是基于OpenSTF原理实现的。因此，我们对OpenSTF项目进行了深入研究。</p><h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><p>我们首先按照OpenSTF官方的方案进行了搭建，并进行了小规模的应用，但渐渐的我们发现了它的一些问题：</p><ul><li>模块过多而且耦合紧密，解耦难度较大，每次修改需要更新所有模块，难以快速迭代开发。</li><li>部分技术选型落后。由于OpenSTF出现的时间比较早，部分技术已经落后于目前的主流。例如OpenSTF前端选用AngularJS 1.0进行开发，在生态链方面已经落后于其他流行的框架；数据库方面选用非关系型数据库RethinkDB，在数据计算和性能方面弱于MySQL等关系型数据库，同时RethinkDB资料较少，不便于开发与维护。</li><li>OpenSTF屏幕图像传输采用图片单张传输的方式进行，而且画质不能由用户来调节，实际应用中占用带宽很高，在网络比较差的情况下会有严重的卡顿现象，体验很差。</li></ul><h2 id="我们的方案"><a href="#我们的方案" class="headerlink" title="我们的方案"></a>我们的方案</h2><h3 id="架构设计"><a href="#架构设计" class="headerlink" title="架构设计"></a>架构设计</h3><p>根据业务场景的需要，并吸取了OpenSTF结构优点，我们采用Agent/Server模型的模块化设计方案。下面分别介绍主要模块的功能：</p><ul><li>Agent模块。Agent模块与OpenSTF的provider类似，部署在服务器上或者用户的电脑上，Agent连接真实的手机，并且将手机的屏幕图像通过Websocket动态代理到Websocket服务器上，然后通过消息中心来进行消息的传递。</li><li>Server模块。Server用来集中管理和调度手机，与OpenSTF结构不同的是，我们的Server端包含Web服务器、Websocket服务器、动态代理以及消息处理服务等部分，Server将用户的访问动态代理到对应的Web服务器和Websocket服务器上，并通过消息处理模块向消息中心传递消息，实现用户与Agent端手机的交互。</li><li>数据存储模块。数据存储模块用来保存整个平台的数据，例如手机的状态、用户使用记录等。数据存储模块由MySQL数据库和一个RPC服务组成，Server不再直接读写数据库，而是通过一个RPC服务来进行数据的读写操作。</li><li>消息中心。与OpenSTF的triproxy功能类似，是连接手机和Server的枢纽，消息中心主要处理屏幕的操作以及手机的状态变更等消息。</li></ul><p>通过模块化设计，项目结构比OpenSTF更加清晰。下面是整个系统的设计图：</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/mpd2a.png" alt="image-20190724174027146"></p><h3 id="架构的优势"><a href="#架构的优势" class="headerlink" title="架构的优势"></a>架构的优势</h3><p>Agent模块我们直接复用了OpenSTF的provider大部分功能，包括minicap、minitouch等。在此基础上，我们也扩展了一部分OpenSTF缺失的功能，比如：</p><ul><li>在provider的基础上进行了二次开发，使其支持画质/帧率调节（下文会有详细说明）。</li><li>加入健康检测功能，检测手机网络是否正常、是否设置了网络代理等。</li><li>加入Inspector功能，方便获取UI控件树（下文会有详细说明）。</li><li>对Agent进行了版本区分，便于Web端根据不同的Agent版本对相应的功能展示和隐藏。</li></ul><p>在Server模块中，我们引入了动态代理的机制，并且重新开发了Web部分，采用了Vue 2.0 + iView来实现，数据库采用了MySQL。</p><p>相比OpenSTF原生架构，总结下来有以下优势：</p><ul><li>模块耦合程度低，开发和部署更方便。OpenSTF各个功能模块不仅数量多而且代码耦合紧密，在此基础上进行二次开发和部署非常困难。而我们将整个项目分为Server、Agent、消息中心、数据存储四个模块，四个模块功能和代码都是独立的，基本上没有耦合关系，支持快速迭代开发，部署也很方便。</li><li>前端框架更主流，开发和维护成本低。OpenSTF前端是使用AngularJS 1.0实现的，AngularJS 1.0已经处于废弃阶段，各种第三方组件基本已经停止支持，AngularJS 2.0的社区和生态并未成熟，而我们采用了Vue 2.0前端框架，Vue 2.0相对已经成熟，在美团侧也已经有大量应用，能够快速开发高质量的Web功能。</li><li>数据库性能强，设计灵活、维护方便。OpenSTF使用RethikDB作为数据库，RethikDB是一个NoSQL型数据库，它有非常多的缺点，比如处理大量数据时的性能很差，资料非常匮乏，排查问题和数据库维护都非常困难。而我们采用了MySQL数据库，很好的解决了这些问题，并且实现了Server模块与数据读写的分离，这样在更新数据库表结构的时候无须同时修改Server端的代码，只要保证RPC服务的接口格式一致即可，开发和维护更加方便。</li></ul><p>除了这些基础的功能之外，我们还开发了一些特色的功能，下面我们来详细介绍。</p><h2 id="特色功能"><a href="#特色功能" class="headerlink" title="特色功能"></a>特色功能</h2><h3 id="与客户端自动化相结合"><a href="#与客户端自动化相结合" class="headerlink" title="与客户端自动化相结合"></a>与客户端自动化相结合</h3><p>为了合理、高效利用测试手机资源，我们与客户端自动化进行了结合，主要有两个方面：</p><ul><li>与集团内部的云测平台深度融合。在云测平台的服务器节点上部署Agent代码，为云测平台自动化任务创建者提供自动化过程展示和远程调试功能，同时将云测平台空闲的手机开放给更多人使用。</li><li>开放API。我们开放了一些API给普通用户，供用户查询手机状态、占用手机、连接adb调试等，用户可以使用脚本调用API，然后直接在平台的手机上进行自动化测试。</li></ul><h3 id="预约功能"><a href="#预约功能" class="headerlink" title="预约功能"></a>预约功能</h3><p>当一台手机处于繁忙状态时，用户必须要等待手机空闲后才能使用，由于手机空闲时间不确定，就会给用户带来很大的不便。为了解决这个问题，我们开发了手机预约的功能，用户可以预约处于繁忙状态的手机，当手机空闲时，自动帮预约用户占用15分钟，并通过即时通讯工具通知预约人。</p><h3 id="画质调节"><a href="#画质调节" class="headerlink" title="画质调节"></a>画质调节</h3><p>远程调试平台的核心是实时获取屏幕图像，由于屏幕传输需要比较大的网络带宽，在网络不佳的情况下就会出现卡顿现象。因此，我们针对不同的网络做了一些流畅度的优化，下面来介绍一下其中的细节。</p><p>屏幕获取的原理是通过minicap来高速截图，每秒最高可达60张，然后将这些截图显示在Web上。因此，我们考虑从两个方面来优化网络带宽的占用，<strong>第一个是调节截图的质量</strong>，minicap本身支持调节画质（OpenSTF固定设置了80%的压缩比），关键代码如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> rate =  <span class="built_in">Number</span>(match[<span class="number">6</span>])</span><br><span class="line">    <span class="keyword">if</span> (rate &gt; <span class="number">2</span> &amp;&amp; rate &lt; <span class="number">100</span>) &#123;</span><br><span class="line">      log.info(rate)</span><br><span class="line">      <span class="keyword">if</span> (rate &gt; <span class="number">30</span>) &#123;</span><br><span class="line">        options.screenJpegQuality = <span class="number">80</span></span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span> (rate &gt; <span class="number">15</span>) &#123;</span><br><span class="line">        options.screenJpegQuality = <span class="number">50</span></span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        options.screenJpegQuality = <span class="number">20</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      frameProducer.restart()</span><br><span class="line">      framerate = rate</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>第二个是调节每秒发送的图片张数</strong>，也就是帧率，我们可以在Agent端控制发送图片的数量，关键代码如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 首先修改帧率发送部分：</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wsFrameNotifier</span>(<span class="params">frame</span>) </span>&#123;  </span><br><span class="line">  <span class="keyword">if</span> (latesenttime == <span class="number">0</span> || <span class="built_in">Date</span>.now()-latesenttime &gt; <span class="number">1000</span>/framerate) &#123;  </span><br><span class="line">    latesenttime = <span class="built_in">Date</span>.now()  </span><br><span class="line">    <span class="keyword">return</span> send(frame, &#123;  </span><br><span class="line">      binary: <span class="literal">true</span>  </span><br><span class="line">    &#125;)  </span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"># 再加入调整帧率的代码：</span><br><span class="line"><span class="keyword">case</span> <span class="string">'rate'</span>:  </span><br><span class="line">  <span class="keyword">var</span> rate =  <span class="built_in">Number</span>(match[<span class="number">6</span>])  </span><br><span class="line">  <span class="keyword">if</span> (rate &gt; <span class="number">2</span> &amp;&amp; rate &lt; <span class="number">100</span>) &#123;  </span><br><span class="line">    framerate = rate  </span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>那么，帧率和图片压缩比调节到多少才能满足不同网络环境的需要呢？我们先来看一组数据：</p><table><thead><tr><th><strong>图片压缩比</strong></th><th>图片尺寸</th></tr></thead><tbody><tr><td>100%</td><td>69.82KB</td></tr><tr><td>80%</td><td>46.78KB</td></tr><tr><td>50%</td><td>41.87KB</td></tr><tr><td>20%</td><td>37.84KB</td></tr><tr><td>10%</td><td>35.84KB</td></tr></tbody></table><p>表中是使用minicap做的图片压缩实验，从数据中我们可以看到当图片质量降低到80%时图片大小降低比较明显，而图片质量并没有明显的下降。继续降低图片质量，图片大小降低有限。我们再来看另外一组数据：</p><table><thead><tr><th>帧率</th><th>图片压缩比</th><th>实际流量</th></tr></thead><tbody><tr><td>60</td><td>100%</td><td>4.02M/S</td></tr><tr><td>60</td><td>80%</td><td>2.74M/S</td></tr><tr><td>60</td><td>50%</td><td>2.41M/S</td></tr><tr><td>30</td><td>80%</td><td>1.43M/S</td></tr><tr><td>30</td><td>50%</td><td>1.22M/S</td></tr><tr><td>30</td><td>20%</td><td>1.10M/S</td></tr><tr><td>15</td><td>50%</td><td>0.63M/S</td></tr><tr><td>15</td><td>20%</td><td>0.55M/S</td></tr><tr><td>15</td><td>10%</td><td>0.52M/S</td></tr></tbody></table><p>表中是各种帧率和压缩比组合产生的实际流量数据。</p><p>从数据中我们可以看到最高帧率和压缩比的组合下，流量达到了4M/S，而80%压缩比时流量减小到了2.7M/S，降低非常明显。考虑到实际网络情况，我们将<strong>60帧、80%压缩作为了高画质选项</strong>。</p><p>而图片质量从80%降低到50%时图片大小下降并不明显，此时降低帧率就成了很好的选择。当帧率降低到30帧时流量降低了一半，1.2M/S的流量能够满足大部分网络状况使用，30帧也能保证操作的流畅度，于是<strong>30帧、50%压缩比成为了中画质的选项</strong>。</p><p>低画质主要是为了保证在较差的网络环境能够正常使用，500K/S的流量是红线。我们将<strong>15帧、20%压缩比作为低画质选项</strong>，此时图片质量和帧率较低，但能够保证基本的使用体验。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/izjho.gif" alt="img"></p><p>除了通过降低图片质量和帧率来减小手机屏幕图像传输的流量外，将图像使用H264等编码压缩成视频传输也是一种有效降低流量的办法，相对于图片，图像的压缩率将会更高，用户的操作体验也会更好。但是图像压缩编码原理比较复杂，相关技术我们还在研究当中。</p><h3 id="App-Mock"><a href="#App-Mock" class="headerlink" title="App Mock"></a>App Mock</h3><p>在做App测试过程中经常需要抓包，一般情况下，我们通过修改WiFi的代理然后用抓包工具就可以实现。但是这样做的效率比较低，多个工具切换也非常不便。借助集团的Mock平台，我们开发了一键Mock功能，能够快速完成相应App的Mock操作。带来的好处是我们可以一边操作App，一边查看App发出的请求，大大提高了测试的效率。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/ykq4i.gif" alt="img"></p><h3 id="App-Inspector"><a href="#App-Inspector" class="headerlink" title="App Inspector"></a>App Inspector</h3><p>App Inspector功能可以让用户在平台上使用真机的同时查看页面控件树及页面元素，并且支持Xpath，更加方便高效的查找页面元素，给UI自动化测试提供了很大便利。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/tb4mj.gif" alt="img"></p><p>这个功能我们是借助Uiautomator实现的。基本原理是写一个Uiautomator用例，用来获取当前页面的Hierarchy，然后将用例打包成一个JAR放到Agent端。当在Web端触发获取控件树时，Agent将JAR包推送到手机上并运行，此时会在手机端生成一个XML文件。然后再使用cat命令获取XML内容并在前端解析。用例核心代码如下：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">launch</span> <span class="keyword">extends</span> <span class="title">UiAutomatorTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDumpHierarchy</span><span class="params">()</span> <span class="keyword">throws</span> UiObjectNotFoundException </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">"/data/local/tmp/local/tmp/uidump.xml"</span>);</span><br><span class="line">        UiDevice uiDevice = getUiDevice();</span><br><span class="line">        String filename = <span class="string">"uidump.xml"</span>;</span><br><span class="line">        uiDevice.dumpWindowHierarchy(filename);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然，你也可以用adb命令来获取Hierarchy：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">adb shell uiautomator dump /data/local/tmp/uidump.xml</span><br></pre></td></tr></table></figure><p>但这种方式不能获取动态页面，比如视频播放页面。</p><h3 id="数据报表"><a href="#数据报表" class="headerlink" title="数据报表"></a>数据报表</h3><p>为了更好的了解平台的运营情况，我们做了详细的数据统计，主要从使用次数、使用时间、设备数量、使用分布等方面进行统计。目前我们管理的手机近300台，平均每个月有超过500名研发人员在使用我们的平台，每天的使用次数达到280次，每天总使用时长超过60小时。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/ppx4b.png" alt="img"></p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/5qbm5.png" alt="img"></p><h3 id="其他小功能"><a href="#其他小功能" class="headerlink" title="其他小功能"></a>其他小功能</h3><p>除了以上几个比较大的功能点，我们也做了一些贴心的小功能，比如：检测手机网络是否设置代理、检测手机已安装的应用版本及安装时间、快速安装最新版本的测试包、支持App内的Schema跳转等等。这些小功能为研发人员节省了很多时间，提升了他们的工作效率。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/a1qy6.png" alt="img"></p><h2 id="未来规划"><a href="#未来规划" class="headerlink" title="未来规划"></a>未来规划</h2><h3 id="iOS手机支持"><a href="#iOS手机支持" class="headerlink" title="iOS手机支持"></a>iOS手机支持</h3><p>目前，云真机平台只支持Android手机，对iOS手机的支持正在进行中。我们已经初步完成了主要功能的开发，预计很快将与大家见面。</p><h3 id="产品优化"><a href="#产品优化" class="headerlink" title="产品优化"></a>产品优化</h3><p>我们计划继续扩展产品功能，比如支持Log日志展示和性能数据采集等。目前云真机平台已经在美团点评内部平稳运行超过两年，我们会继续不断迭代版本、打磨产品，提供更好的使用体验。</p><h2 id="作者简介"><a href="#作者简介" class="headerlink" title="作者简介"></a>作者简介</h2><p>东初，大众点评平台质量工具组负责人。7年互联网行业测试、开发经验，2015年加入原大众点评。先后主导了云真机平台、单元测试平台、web安全实验平台等项目的开发，致力于用工具来提升研发团队的工作效率。</p><p>李帅，大众点评高级测试开发工程师。2015年加入原大众点评，主要负责云真机平台的开发以及客户端底层组件的测试。热衷于钻研测试领域的前沿技术，并推动了多项新技术落地。</p><h2 id="原文信息-好文章值得完整复制收藏，避免原文也没了"><a href="#原文信息-好文章值得完整复制收藏，避免原文也没了" class="headerlink" title="原文信息(好文章值得完整复制收藏，避免原文也没了)"></a>原文信息(好文章值得完整复制收藏，避免原文也没了)</h2><p>作者：美团技术团队</p><p>链接：<a href="https://juejin.im/post/5b5556eae51d45195f0b3422" target="_blank" rel="noopener">https://juejin.im/post/5b5556eae51d45195f0b3422</a></p><p>来源：掘金</p><p>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;p&gt;随着美团点评业务越来越多，研发团队越来越庞大，对测试手机的需求显著增长。这对公司来说是一笔不小的开支，但现有测试手机资源分配不均，利用率也非常有限，导致各个团队开发、测试过程中都很难做到多机型覆盖。怎么样合理、高效利用这些测试手机资源，是摆在我们面前的一道难题。&lt;/p&gt;
    
    </summary>
    
      <category term="自动化技术" scheme="http://www.cmlanche.com/categories/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="云真机" scheme="http://www.cmlanche.com/tags/%E4%BA%91%E7%9C%9F%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://www.cmlanche.com/2019/07/24/%E7%83%AD%E6%83%85%E4%B8%8D%E5%87%8F%EF%BC%8C%E5%BC%80%E5%90%AF%E8%BD%AC%E5%8F%98%EF%BC%8C%E4%B8%93%E8%AE%BF%E7%8B%AC%E7%AB%8B%E4%BA%A7%E5%93%81%E8%AE%BE%E8%AE%A1%E5%B8%88%20Allen/"/>
    <id>http://www.cmlanche.com/2019/07/24/热情不减，开启转变，专访独立产品设计师 Allen/</id>
    <published>2019-07-24T06:34:52.000Z</published>
    <updated>2019-07-24T06:34:52.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="热情不减，开启转变，专访独立产品设计师-Allen"><a href="#热情不减，开启转变，专访独立产品设计师-Allen" class="headerlink" title="热情不减，开启转变，专访独立产品设计师 Allen"></a>热情不减，开启转变，专访独立产品设计师 Allen</h2><p>原文：<a href="https://indiehacker.im/re-qing-bu-jian-kai-qi-zhuan-bian-zhuan-fang-du-9f863d86" target="_blank" rel="noopener">https://indiehacker.im/re-qing-bu-jian-kai-qi-zhuan-bian-zhuan-fang-du-9f863d86</a></p><p><a href="https://twitter.com/creativewang" target="_blank" rel="noopener">Allen</a> （王老板）是我们的好朋友，Price Tag、<a href="https://sharecuts.cn/" target="_blank" rel="noopener">捷径社区</a>的视觉设计都出自他之手，这个月我们还有新的合作项目即将上线。最近他开始了自己新的事业，做一个全职的独立产品设计师。上半年他上架了 <a href="https://fireball.studio/oneswitch" target="_blank" rel="noopener">One Switch</a> 和「<a href="https://apps.apple.com/cn/app/出彩-视频导出高清照片/id1468642894?ign-mpt=uo%3D4" target="_blank" rel="noopener">出彩</a>」两款优质的应用，其中 One Switch 更是被国外知名应用订阅服务 <a href="https://setapp.com/" target="_blank" rel="noopener">Setapp</a> 收录。今天我们邀请他来和我们聊聊新作品和成为独立产品设计师的体验。</p><h3 id="谈一下你自己现在的状态和你的作品？"><a href="#谈一下你自己现在的状态和你的作品？" class="headerlink" title="谈一下你自己现在的状态和你的作品？"></a>谈一下你自己现在的状态和你的作品？</h3><p>我是一个产品设计师，最近半年经历了前公司的创业失败，所以现在是正式全职的独立产品设计师了。以前自学 Swift 想当独立开发者，现在有点学不动了，哈哈，不过主要是因为自己感受到明显的时间流逝，如果一切自己做对我来说还是太慢了点，完全的全干类型我是挺钦佩的，但因人而异，我会更享受和优秀的人合作过程中碰撞出来的乐趣，所以现在的状态还是挺开放的合作方式，有兴趣一起创造可持续盈利产品的开发者，或是想要塑造自己业务的公司都可以来找我和我的伙伴们。</p><p><a href="https://fireball.studio/oneswitch" target="_blank" rel="noopener"><strong>One Switch</strong></a> 这是款极简的 Mac 菜单栏效率工具，可以帮你一键切换系统各项设置，搞定日常繁琐，比如隐藏桌面，自动切换黑暗模式，让电脑不熄屏，快速暂停和播放 Spotify 和 Apple Music，连接 AirPods 以及其他蓝牙耳机等等。</p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/7qut8.jpg" alt="One Switch.jpg"></p><p><a href="https://apps.apple.com/cn/app/%E5%87%BA%E5%BD%A9-%E8%A7%86%E9%A2%91%E5%AF%BC%E5%87%BA%E9%AB%98%E6%B8%85%E7%85%A7%E7%89%87/id1468642894?ign-mpt=uo%3D4" target="_blank" rel="noopener"><strong>出彩 App</strong></a> 快速从视频、LivePhotos、GIF 动图导出高清照片。</p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/fcipx.png" alt="åºå½©.png"></p><h3 id="你的一天生活和工作日常是怎么样的？"><a href="#你的一天生活和工作日常是怎么样的？" class="headerlink" title="你的一天生活和工作日常是怎么样的？"></a>你的一天生活和工作日常是怎么样的？</h3><ul><li><strong>08:00 - 10:00 早起时间</strong>：起床，户外跑步，做咖啡，收拾下今天的健身运动包，有时候会先在家工作一会儿处理海外用户的反馈邮件，私信，安排好今天的 To-Do 清单。</li><li><strong>10:00 - 12:30 交通时间</strong>：公交转地铁，路上快速浏览今日科技和设计新闻，到浙大附近 Price Tag 办公室楼下吃饭，有时候在家吃完再出门。</li><li><strong>13:00 - 20:00 工作时间</strong>：有时在各种城市咖啡店，有时在 Price Tag 办公室，今天在 WeWork 写这篇访谈，我喜欢在一个不固定的地方工作。</li><li><strong>20:30 - 21:30 健身时间</strong>：撸铁半小时，跑步或游泳半小时。</li><li><strong>23:30 - 00:00 睡觉时间</strong>：打开 Sleep Cycle 统计睡眠时间。</li></ul><h3 id="One-Switch-是如何诞生的？"><a href="#One-Switch-是如何诞生的？" class="headerlink" title="One Switch 是如何诞生的？"></a>One Switch 是如何诞生的？</h3><p>这是一个我自身有强烈需求的产品，我本身不是 macOS 的 Power User, 所以或许有些人知道的热键我其实也记不住，包括如何快速打开屏保，在设计的时候来回切换黑暗模式，桌面乱的可以，但是之前使用的一款隐藏桌面图标的软件也无法在 Mojave 里工作，所以很丧气。然后我就开始从 Menubar 这个 macOS 宝地入手开始构思集成多个开关功能的效率产品，一开始只是用 InVision Studio 快速设计了 One Switch 的开关动画，图拉鼎看过后竟然也也很快实现了这个效果，所以后面自然就确定开始打造这款产品，今年 3 月份底上架，前后花了断断续续一个月时间，但其实真实时间应该在 2 个星期左右。</p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/w3vnw.gif" alt="One Switch æåå¼å³å¨ç».gif"></p><h3 id="One-Switch-作为少数上架-Setapp-的国内团队有什么经验和有趣的事情可以分享的？"><a href="#One-Switch-作为少数上架-Setapp-的国内团队有什么经验和有趣的事情可以分享的？" class="headerlink" title="One Switch 作为少数上架 Setapp 的国内团队有什么经验和有趣的事情可以分享的？"></a>One Switch 作为少数上架 Setapp 的国内团队有什么经验和有趣的事情可以分享的？</h3><p>对我们两人团队来说，能上架 Setapp 其实是个特别大的惊喜，当 Setapp 的运营经理 Maria 发来私信邀请我们上架的时候，真是太激动了，因为这意味着可以跟那些优秀的知名 macOS App 登上同一个平台，同时这也是对我们产品功能和设计的一个肯定。本身由于 Apple 沙盒环境的限制，我们就无缘了 Mac App Store，而 Setapp 的出现给了我们一个渠道，这对独立分发的 macOS App 是极其宝贵的。</p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/fres7.png" alt="One Switch Setapp.png"></p><p>想要上架 Setapp 的开发者们，可以先让自己的用户（同时是 Setapp 的用户）在他们的 <a href="https://trello.com/b/V2SyhK5n/suggested-apps-for-setapp" target="_blank" rel="noopener">Trello</a>上提出自己希望可以让哪些 App 加入 Setapp，他们看过后觉得不错符合他们的标准就会去找开发者联系邀请上架，但首先你必须是一个付费的产品。</p><p>然后分成单独的 Target，把原来独立发行时的免费试用、License 购买和验证等替换成Setapp SDK 就可以单独提交到 Setapp 供应商后台上架，审核很快，最后会确定一个上架时间配合 Setapp 运营团队开始正式推送到商店，社交媒体，以及他们的邮件订阅列表。</p><p>其实这里面最有趣的是，很多国内 Setapp 用户甚至我们的朋友，突然电脑右上角收到一个熟悉的图标的推送后纷纷截图恭喜我们，有种登上舞台开始你的表演的感觉。</p><p>后面陆续收到很多 Setapp 用户的反馈，每天早上一打开手机就是这些邮件，有前 Apple 的员工，各个国家的设计师和开发者，还有甚至在 Pixar 时期和乔布斯合作过的工程师，真的都是满满的感激。</p><h3 id="出彩这个产品的起源背景是怎么样的？"><a href="#出彩这个产品的起源背景是怎么样的？" class="headerlink" title="出彩这个产品的起源背景是怎么样的？"></a>出彩这个产品的起源背景是怎么样的？</h3><p>我自己经常户外跑步，每次跑完都会拍照然后用 Nike Running Club 分享到 IG 和朋友圈，这基本是属于我的跑步例程了吧，但是每次一个人跑步拍照有点麻烦，因为不想浪费太多时间，而且前后有人也不方便，所以就想到用拍视频的方式来代替拍照，回去后找到一帧截图就行，可是截图分辨率不高，如果我可以直接导出跟视频一样高清的图片就好了，这就想到了做这样一个简单的工具类产品。在那个时候一个工程师朋友正好也想尝试下新技术 Flutter, 所以最后是用 Flutter 同时实现了 Android 和 iOS 两端，虽然 Flutter 在 iOS 上的体验有待提升，但作为一个简单的小工具我觉得也够了，后续我们也会持续改进，当然也有可能以后用 SwiftUI 重写 iOS 端。</p><h3 id="作为创意工作者，你是从哪里获得灵感的？"><a href="#作为创意工作者，你是从哪里获得灵感的？" class="headerlink" title="作为创意工作者，你是从哪里获得灵感的？"></a>作为创意工作者，你是从哪里获得灵感的？</h3><p>一直以来我就关注很多国外开发者、设计师、创始人、创业公司的推特，这也是我日常最大的信息来源，创造者本身是最大的灵感来源，你会被他们的想法，原型，作品以及日常生活和工作方式给影响，然后启发你用更国际化和多元的思维去创造产品。</p><p>Dribbble 对大家不陌生，也是我个人的很大的设计灵感来源，当然主要是可以发我自己的一些真实产品设计的细节。不过自从被收购后，Dribbble 变得太多，流行页面也已经被各种花里胡哨没有逻辑的 Mockup 给占领，很多很厉害的设计师离开这个平台，这是一种悲伤，但看到更多新的真实产品的 Case Study 以及插画艺术作品持续涌现，我还是会继续吸收，学习和输出的。</p><h3 id="你的工作配置是怎么样的？"><a href="#你的工作配置是怎么样的？" class="headerlink" title="你的工作配置是怎么样的？"></a>你的工作配置是怎么样的？</h3><p><strong>工作台</strong></p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/lbgua.jpg" alt="å·¥ä½å°.jpeg"></p><p><strong>macOS</strong></p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/0uwyz.png" alt="macOS é¦é¡µ2.png"></p><p><strong>iPhone</strong></p><p><img src="https://indiehackers.oss-cn-beijing.aliyuncs.com/indiehackers/srek7.png" alt="Artboard.png"></p><h3 id="你希望-iOS-13-有哪些更好的改进？"><a href="#你希望-iOS-13-有哪些更好的改进？" class="headerlink" title="你希望 iOS 13 有哪些更好的改进？"></a>你希望 iOS 13 有哪些更好的改进？</h3><ul><li>首页图标可以按颜色，应用分类，常用应用自动排列，可以隐藏应用图标，在 Spotlight 输入或者 Siri 呼唤打开就可以。</li><li>希望 Apple 能认真重视下国内 iMessage 垃圾短信拥挤不堪这个事实。</li><li>希望开放下 ScreenTime API.</li></ul><h3 id="最喜欢的几个-App-是什么？"><a href="#最喜欢的几个-App-是什么？" class="headerlink" title="最喜欢的几个 App 是什么？"></a>最喜欢的几个 App 是什么？</h3><ul><li><strong><a href="https://apps.apple.com/cn/app/sleep-cycle-%E6%99%BA%E8%83%BD%E9%97%B9%E9%92%9F/id320606217?uo=4&amp;at=1001lsTF&amp;ct=320606217#id1047562725" target="_blank" rel="noopener">Sleep Cycle</a></strong>: 最近更新到了 2.0，设计和体验提交到了一个新的层次，累积使用超过 2 年，最喜欢它的深度睡眠检测功能。</li><li><strong><a href="https://apps.apple.com/cn/app/%E7%86%8A%E6%8E%8C%E8%AE%B0/id1016366447?uo=4&amp;at=1001lsTF&amp;ct=1016366447#id1047562725" target="_blank" rel="noopener">Bear 熊掌记</a></strong>：这篇访谈就是这里写的，也是成功带我进入 Markdown 格式写作习惯的编辑器，之前很多我都没怎么适应得了，我讨厌需要记很多东西才能用的产品，最喜欢它的Markdown 语法提示和三种分栏自由切换。</li><li><strong><a href="https://fireball.studio/oneswitch" target="_blank" rel="noopener">One Switch</a></strong>：虽然是自己做的，但不得不说我已经很难离开它了，每次打开 Mac 的日常就是连接 AirPods，然后打开 Spotify，两个开关搞定。</li><li><strong><a href="https://apps.apple.com/cn/app/procreate-pocket/id916366645?uo=4&amp;at=1001lsTF&amp;ct=916366645#id1047562725" target="_blank" rel="noopener">Procreate Pocket</a></strong>：30 块钱一个 App 配一只 20 块钱触摸笔，你就可以随时画沙雕插画，最喜欢它的录制功能，以及从 iCould 云盘里导入笔刷。</li></ul><p><img src="https://i.typcdn.com/indie/8436210914_382618.jpg" alt="Procreate Pocket.jpg"></p><h3 id="我们还可以在哪里关注到你和你作品的动态？"><a href="#我们还可以在哪里关注到你和你作品的动态？" class="headerlink" title="我们还可以在哪里关注到你和你作品的动态？"></a>我们还可以在哪里关注到你和你作品的动态？</h3><p>大部分时间在 Twitter 和微博，经常也会用 Instagram Story 发一些设计的过程和草稿，Dribbble 用来发设计作品，当然希望大家也可以关注下我们 Fireball 烧蛋工作室。</p><ul><li>Twitter： @<a href="https://twitter.com/creativewang" target="_blank" rel="noopener">creativewang</a></li><li>微博：@<a href="https://weibo.com/wangchaohui" target="_blank" rel="noopener">Allen朝辉</a></li><li>Instagram： @<a href="https://www.instagram.com/allllllllllen/" target="_blank" rel="noopener">alllllllllen</a></li><li>Dribbble： <a href="https://dribbble.com/openallen" target="_blank" rel="noopener">openallen</a></li><li>Fireball Twitter： @<a href="https://twitter.com/fireball_studio" target="_blank" rel="noopener">fireball_studio</a></li><li>Fireball 微博： @<a href="https://weibo.com/fireballstudio?topnav=1&amp;wvr=6&amp;topsug=1" target="_blank" rel="noopener">烧蛋工作室</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;热情不减，开启转变，专访独立产品设计师-Allen&quot;&gt;&lt;a href=&quot;#热情不减，开启转变，专访独立产品设计师-Allen&quot; class=&quot;headerlink&quot; title=&quot;热情不减，开启转变，专访独立产品设计师 Allen&quot;&gt;&lt;/a&gt;热情不减，开启转变，专
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>记录一次网络拥塞导致线程池处于等待状态</title>
    <link href="http://www.cmlanche.com/2019/07/12/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E7%BD%91%E7%BB%9C%E6%8B%A5%E5%A1%9E%E5%AF%BC%E8%87%B4%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%A4%84%E4%BA%8E%E7%AD%89%E5%BE%85%E7%8A%B6%E6%80%81/"/>
    <id>http://www.cmlanche.com/2019/07/12/记录一次网络拥塞导致线程池处于等待状态/</id>
    <published>2019-07-12T09:37:44.000Z</published>
    <updated>2019-07-12T09:45:55.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><p>一次批量执行任务（12个），最后任务执行成功会批量上传图片，导致线程池都处于等待状态。</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/hdkut.jpg?x-oss-process=style/logomark" alt="19481562921545_.pic_hd"></p><p>首先这个线程池是通过<code>newSingleThreadExecutor</code>来创建的，并且在执行过程中，不会有新的任务进来，当时的情况是在线程执行过程中卡主，实际发生在上传图片，类似的线程池多大12个，每个线程上传的图片可能多大上百张。</p><a id="more"></a><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>分析上面jstack打印的日志（打印方法是<code>jstack pid</code>），有个<code>waiting on condition</code>，它的含义，我搜了下，是这样的</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/oh7zg.jpg?x-oss-process=style/logomark" alt="19541562924017_.pic_hd"></p><p>由此可以猜测，可能是大并发上传图片导致网络拥塞</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p>做一个固定线程大小的线程池，比如3个，专门用于并发上传图片，避免网络拥塞。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;场景&quot;&gt;&lt;a href=&quot;#场景&quot; class=&quot;headerlink&quot; title=&quot;场景&quot;&gt;&lt;/a&gt;场景&lt;/h3&gt;&lt;p&gt;一次批量执行任务（12个），最后任务执行成功会批量上传图片，导致线程池都处于等待状态。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/hdkut.jpg?x-oss-process=style/logomark&quot; alt=&quot;19481562921545_.pic_hd&quot;&gt;&lt;/p&gt;
&lt;p&gt;首先这个线程池是通过&lt;code&gt;newSingleThreadExecutor&lt;/code&gt;来创建的，并且在执行过程中，不会有新的任务进来，当时的情况是在线程执行过程中卡主，实际发生在上传图片，类似的线程池多大12个，每个线程上传的图片可能多大上百张。&lt;/p&gt;
    
    </summary>
    
    
      <category term="java性能优化" scheme="http://www.cmlanche.com/tags/java%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>问答四部曲</title>
    <link href="http://www.cmlanche.com/2019/06/20/%E5%9B%9E%E7%AD%94%E9%97%AE%E9%A2%98%E5%9B%9B%E9%83%A8%E6%9B%B2/"/>
    <id>http://www.cmlanche.com/2019/06/20/回答问题四部曲/</id>
    <published>2019-06-20T02:11:05.000Z</published>
    <updated>2019-07-24T09:36:03.000Z</updated>
    
    <content type="html"><![CDATA[<ol><li>它是什么</li><li>影响和意义</li><li>怎么解决的</li><li>有什么心得</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;它是什么&lt;/li&gt;
&lt;li&gt;影响和意义&lt;/li&gt;
&lt;li&gt;怎么解决的&lt;/li&gt;
&lt;li&gt;有什么心得&lt;/li&gt;
&lt;/ol&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>部分手机adb install快速返回成功导致appium测试失败的解决办法</title>
    <link href="http://www.cmlanche.com/2019/06/19/%E9%83%A8%E5%88%86%E6%89%8B%E6%9C%BAadb-install%E5%BF%AB%E9%80%9F%E8%BF%94%E5%9B%9E%E6%88%90%E5%8A%9F%E5%AF%BC%E8%87%B4appium%E6%B5%8B%E8%AF%95%E5%A4%B1%E8%B4%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/"/>
    <id>http://www.cmlanche.com/2019/06/19/部分手机adb-install快速返回成功导致appium测试失败的解决办法/</id>
    <published>2019-06-19T03:20:06.000Z</published>
    <updated>2019-06-19T03:25:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>我们可以在命令行中执行adb install安装某个应用，会发现快速返回Success了，而实际应用正在安装中，这种情况下，appium会误以为被测应用已经安装上了，然后去启动这个app，结果发现app不存在（appium重重试一次，仍然失败），这种情况下，appium测试100%会失败。</p><p>事故手机：OPPO R9sk</p><p>测试的Appium版本：1.12.1</p><a id="more"></a><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>找到安装app的地方，安装完后，检测app是否真正安装成功了，如果没成功，则等待，直到超时或者成功安装。</p><h2 id="实施办法"><a href="#实施办法" class="headerlink" title="实施办法"></a>实施办法</h2><p>针对UIAutomator1，我们需要更改appium-android-driver，我们找到lib/driver.js的initAUT方法，在代码await helpers.installApk(this.adb, this.opts);后加上这个检测过程：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">await</span> helpers.installApk(<span class="keyword">this</span>.adb, <span class="keyword">this</span>.opts);</span><br><span class="line">log.info(<span class="string">'安装应用后，检查被测应用是否存在'</span>);</span><br><span class="line"><span class="keyword">await</span> <span class="keyword">this</span>.waitPackagePresent(<span class="number">60000</span>);</span><br></pre></td></tr></table></figure><p>waitPackagePresent就是这个检测过程的方法，代码如下：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 一定时间内等待某包出现</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">async</span> waitPackagePresent (timeout) &#123;</span><br><span class="line">   log.info(<span class="string">`waitPackagePresent: <span class="subst">$&#123;timeout&#125;</span>`</span>);</span><br><span class="line">   <span class="keyword">let</span> start = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">   <span class="keyword">while</span> (<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() - start &lt; timeout) &#123;</span><br><span class="line">     <span class="keyword">const</span> appState = <span class="keyword">await</span> <span class="keyword">this</span>.adb.getApplicationInstallState(<span class="keyword">this</span>.opts.app, <span class="keyword">this</span>.opts.appPackage);</span><br><span class="line">     log.info(<span class="string">`app state is <span class="subst">$&#123;appState&#125;</span> 1`</span>);</span><br><span class="line">     <span class="keyword">switch</span> (appState) &#123;</span><br><span class="line">       <span class="keyword">case</span> <span class="string">'notInstalled'</span>:</span><br><span class="line">         log.info(<span class="string">`检测到<span class="subst">$&#123;<span class="keyword">this</span>.opts.appPackage&#125;</span>尚未安装上，等待1s，继续检测`</span>);</span><br><span class="line">         <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span><br><span class="line">         <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">default</span>:</span><br><span class="line">         log.info(<span class="string">'被测应用已安装上'</span>);</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   log.errorAndThrow(<span class="string">`Could not find package <span class="subst">$&#123;<span class="keyword">this</span>.opts.appPackage&#125;</span> on the device in <span class="subst">$&#123;timeout&#125;</span>`</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>而针对UIAutomator2的话，同样我们找到UIAutomator2的nodejs驱动工程：appium-uiautomator2-driver，然后找到lib/driver.js，同样也是在initAUT方法中：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.opts.app) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.opts.noSign &amp;&amp; !<span class="keyword">await</span> <span class="keyword">this</span>.adb.checkApkCert(<span class="keyword">this</span>.opts.app, <span class="keyword">this</span>.opts.appPackage)) &#123;</span><br><span class="line">    <span class="keyword">await</span> helpers.signApp(<span class="keyword">this</span>.adb, <span class="keyword">this</span>.opts.app);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">await</span> helpers.installApk(<span class="keyword">this</span>.adb, <span class="keyword">this</span>.opts);</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">this</span>.waitPackagePresent(<span class="number">60000</span>); <span class="comment">// 这是新增</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>waitPackagePresent方法同上。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我们可以在命令行中执行adb install安装某个应用，会发现快速返回Success了，而实际应用正在安装中，这种情况下，appium会误以为被测应用已经安装上了，然后去启动这个app，结果发现app不存在（appium重重试一次，仍然失败），这种情况下，appium测试100%会失败。&lt;/p&gt;
&lt;p&gt;事故手机：OPPO R9sk&lt;/p&gt;
&lt;p&gt;测试的Appium版本：1.12.1&lt;/p&gt;
    
    </summary>
    
      <category term="Appium" scheme="http://www.cmlanche.com/categories/Appium/"/>
    
    
      <category term="appium" scheme="http://www.cmlanche.com/tags/appium/"/>
    
      <category term="adb-install" scheme="http://www.cmlanche.com/tags/adb-install/"/>
    
  </entry>
  
  <entry>
    <title>陪伴阿里云走过的5年之路</title>
    <link href="http://www.cmlanche.com/2019/06/16/%E9%99%AA%E4%BC%B4%E9%98%BF%E9%87%8C%E4%BA%91%E8%B5%B0%E8%BF%87%E7%9A%845%E5%B9%B4%E4%B9%8B%E8%B7%AF/"/>
    <id>http://www.cmlanche.com/2019/06/16/陪伴阿里云走过的5年之路/</id>
    <published>2019-06-16T14:53:07.000Z</published>
    <updated>2019-06-17T06:39:28.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="第一次使用阿里云"><a href="#第一次使用阿里云" class="headerlink" title="第一次使用阿里云"></a>第一次使用阿里云</h3><p>那个时候是2014年，我刚刚从大学毕业出来进入社会工作，这一年也是我萌生想额外做点产品的想法的时候，于是我找到了阿里云。</p><p>翻开阿里云的支付记录，可以清晰的看到第一笔支付发生在2014年3月9日：</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-150130.png?x-oss-process=style/logomark" alt="image-20190616230120771"></p><h3 id="126个交易记录"><a href="#126个交易记录" class="headerlink" title="126个交易记录"></a>126个交易记录</h3><p>时至今日2019年中旬618的时候，我已经从一个阿里云新手成长为了阿里云大使，总共发生了126个交易记录，这5年时间里，阿里云陪我走过了成长最快的工作生活。</p><p>开始我还只是会windows server，因为它有图形界面，那个时候对linux恐惧颇深，感觉深不可测，无法控制。而到现在，我已经精通linux，centos，Ubuntu等系统了。这也是在阿里云服务器中慢慢学习过来的。</p><a id="more"></a><h3 id="夭折了几个产品"><a href="#夭折了几个产品" class="headerlink" title="夭折了几个产品"></a>夭折了几个产品</h3><p>之前看<a href="https://www.sitebuilderreport.com/" target="_blank" rel="noopener">sitebuilderreport.com</a>的采访，链接：<a href="http://sideidea.com/article/3" target="_blank" rel="noopener">http://sideidea.com/article/3</a>，知道它月赚29万人民币，这还是2年前的事情了，我就想着模仿它做类似的网站，于是用阿里云做了第一个站，叫virturlhostreport.com，意思就是虚拟主机报告，想做这一块的主机深度评测网站，但是夭折了，一部分也是因为虚拟主机已经日落西山了，另一部分是seo始终没做上去，关键还是我不够坚持吧。</p><p>后来又做了主机排行网，这次就不限定是虚拟主机了，包括云主机和vps，这个网站是采用ghost博客来做的，自己用纯html+css+js来做的，网站速度极快，有网友评论说，”快到让人窒息”。这个网站大概给我挣了2k吧，发布更新了十几个版本，但就是因为更新迭代内容太慢，每次更新基本都需要我重新升级主题，而且我在对主机评测上又有了新的见解。</p><h3 id="现在的产品"><a href="#现在的产品" class="headerlink" title="现在的产品"></a>现在的产品</h3><p>我认为大的客户厂家的服务器基本没有什么性能啊优劣之分，最大的区别在于优惠、价格，如何能帮助客户省钱省时间省力气才是重点，省钱是第一要务。而且不同的客户的省钱方式不太一样，新手和老手不一样，个人和企业又不一样，需求有多种多样。因此我开发了现在的全面的主机优惠站<a href="https://zhaozhuji.info/" target="_blank" rel="noopener">找主机网</a>，简单截个图：</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-153317.jpg?x-oss-process=style/logomark" alt="WX20190616-233157@2x_meitu_2"></p><p>这个网站是我花了大概2个月的业余时间完成的，很是艰辛，基本每天都有提交记录。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-153617.jpg?x-oss-process=style/logomark" alt="dd_meitu_3"></p><p>中间ui写了又换，bootstrap尝试过，放弃了，因为ui实在难看，也在themesforest上买过付费主题，但太笨重，js一大推，弄的我整个工程加载都很忙，界面也不大好，最后采用了bulma的纯css框架做的前端，整个站也按标准的css设计规则来做了，都知道程序员的ui感觉不大好，其实到现在我都觉得我的网站的ui不好看，哪天我还会再整。</p><p>我也设计了后台管理，方面我快速增加内容，修改需求，这也是从上面的失败案例主机排行网而来的，我得能够轻松快速的紧跟市场啊。我甚至自己设计SEO还有站点地图，稍微截个图吧：</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-154219.jpg?x-oss-process=style/logomark" alt="ad_meitu_4"></p><p><strong>为什么要自己写，而不是用WordPress？</strong></p><p>因为WordPress我不太会那些优化，而且关键是不符合我的需求，我是要能够定制不同的客户需求的，WordPress就是无脑的堆砌文章，现在市面上很多主机推荐网站，基本都采用WordPress，但是说真的，里面的内容眼花缭乱的，我认为根本给不到用户实质的价值，这些乱七八糟的内容其实是给搜索引擎看的，至于用户体验，拉倒吧，随你咋看。你去看<a href="https://www.sitebuilderreport.com/" target="_blank" rel="noopener">sitebuilderreport.com</a>，它的内容就井然有序，用户看着非常舒服，它也是作者完全自己写的。</p><h3 id="云大使的收入"><a href="#云大使的收入" class="headerlink" title="云大使的收入"></a>云大使的收入</h3><p>相比很多大佬来说很少，目前总共1427.97元，其中还有80000云气还没兑现。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-155010.png?x-oss-process=style/logomark" alt="image-20190616235009159"></p><p>总共推广了大概150人，累积8人购买。</p><h3 id="关于未来"><a href="#关于未来" class="headerlink" title="关于未来"></a>关于未来</h3><p>坚持把<a href="https://zhaozhuji.info/" target="_blank" rel="noopener">找主机网zhaozhuji.info</a>做下去，坚持每天更新一篇文章，把seo做上去，能够形成不错的自然流量，到那时，也不至于跟现在这样推广的如此艰辛。</p><p>可以的话，帮我点个赞，地址：<a href="https://www.aliyun.com/acts/hi618/delivery?storyId=874749&amp;userCode=mm1tv2if" target="_blank" rel="noopener">https://www.aliyun.com/acts/hi618/delivery?storyId=874749&amp;userCode=mm1tv2if</a>，谢谢！</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;第一次使用阿里云&quot;&gt;&lt;a href=&quot;#第一次使用阿里云&quot; class=&quot;headerlink&quot; title=&quot;第一次使用阿里云&quot;&gt;&lt;/a&gt;第一次使用阿里云&lt;/h3&gt;&lt;p&gt;那个时候是2014年，我刚刚从大学毕业出来进入社会工作，这一年也是我萌生想额外做点产品的想法的时候，于是我找到了阿里云。&lt;/p&gt;
&lt;p&gt;翻开阿里云的支付记录，可以清晰的看到第一笔支付发生在2014年3月9日：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-16-150130.png?x-oss-process=style/logomark&quot; alt=&quot;image-20190616230120771&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;126个交易记录&quot;&gt;&lt;a href=&quot;#126个交易记录&quot; class=&quot;headerlink&quot; title=&quot;126个交易记录&quot;&gt;&lt;/a&gt;126个交易记录&lt;/h3&gt;&lt;p&gt;时至今日2019年中旬618的时候，我已经从一个阿里云新手成长为了阿里云大使，总共发生了126个交易记录，这5年时间里，阿里云陪我走过了成长最快的工作生活。&lt;/p&gt;
&lt;p&gt;开始我还只是会windows server，因为它有图形界面，那个时候对linux恐惧颇深，感觉深不可测，无法控制。而到现在，我已经精通linux，centos，Ubuntu等系统了。这也是在阿里云服务器中慢慢学习过来的。&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="找主机网" scheme="http://www.cmlanche.com/tags/%E6%89%BE%E4%B8%BB%E6%9C%BA%E7%BD%91/"/>
    
  </entry>
  
  <entry>
    <title>奔三分水岭杂想</title>
    <link href="http://www.cmlanche.com/2019/06/16/%E5%A5%94%E4%B8%89%E5%88%86%E6%B0%B4%E5%B2%AD%E6%9D%82%E6%83%B3/"/>
    <id>http://www.cmlanche.com/2019/06/16/奔三分水岭杂想/</id>
    <published>2019-06-16T11:00:38.000Z</published>
    <updated>2019-06-16T11:01:59.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/34v42.jpg?x-oss-process=style/logomark" alt="bensan_meitu_2"></p><p>昨天周六，在家折腾一天新创意，比如做dota2的赛况的小程序，结果审核不让通过，说需要提供4种”让人生畏”的材料，如下图：</p><a id="more"></a><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/ln7s7.png?x-oss-process=style/logomark" alt="image-20190616174938250"></p><p>基本上你想做类似于游戏沾边，热门关键词的话，个人和部分企业是无法申请的，直接把你们拒之门外。</p><p>想到，在中国做点东西真tm难，做出来难，能不能做更是难上加难，尤其对独立开发者来说。国内对创业的环境月来越差，对独立开发者来说也更加艰难，那些能在夹缝中生存的独立开发者，内心真心的佩服。</p><p>我接触了大概600位独立开发者和对独立开发者有兴趣的人，能够真正全职独立的少指又少，阿里一位个人开发者跟我说，”我看大佬们一通操作之后，发现还是上班最靠谱！”，确实啊，真正能做到独立开发大笔盈利的很少。</p><p>我以前对自己说，只要我能够自己稳定一个月赚5k，我就要全职，然后把三倍的时间把5k换成15k。想法很理想，能不能实现倒不说，就算能实现，那也是要经历极其残忍和痛苦的过程，可能这期间你的婚姻、家庭、父母等都承受更多压力，并且以后每天都在担心受怕中，也没有社保公积金等一些社会福利，你是独自一个人在战斗，风险过于庞大，如果你没有靠谱的资金后盾，那这几乎是送死的行为！</p><p>可能是我太着急，也可能是我压力太大，我个人家庭情况不允许我做这样的行为，我之前过的很理想，现在想明白了，我应该找一座能让我干一辈子的一个城，把自己最擅长的专业做到好，这是基本，可以填补我内心的焦躁不安。</p><p>可是我内心的理想却无法填补，一直对自己说，人生不干出名堂，枉来人世了，我的大学的座右铭还是”会当凌绝顶”，我的个人博客标题还是”金鳞岂是池中物”的豪言壮语，可是如今已奔三的我，感受到了什么是婚姻压力，什么是父母健康，什么是未来，我站在人生的分水岭，彷徨而不安，可又没有办法，在奔三的时候，我感觉我看到了我的未来。</p><p>我内心已有答案，人生什么最重要？<strong>我觉得是快乐，是父母的快乐，是兄弟姐妹的快乐，是妻子儿女的快乐，也是我的快乐</strong>，人生确实要有追求，但是不能急于给自己太大的压力去速成，犹记得三国杀某个英雄的一句话”静待良机，一鸣惊人”，慢慢来。</p><p>答案是什么？我的答案就是<strong>莫把客为本</strong>，过快乐生活，我想当个”真正自由人”，想财务解放，奈何实力不允许，那就静待良机吧。</p><p>每个人的答案都可能不一样，莫抄！</p><p>说完，我拿起手机，打开沉睡半年的王者荣耀(滑稽 ~ 玩笑话)</p><p>— 补充</p><p>今天父亲节，深知老爸不容易，祝老爸身体健康，万事如意。也祝各位围观的同学的父亲健健康康，一切都好！</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/8hduv.jpg?x-oss-process=style/logomark" alt="fqj_meitu_1"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/34v42.jpg?x-oss-process=style/logomark&quot; alt=&quot;bensan_meitu_2&quot;&gt;&lt;/p&gt;
&lt;p&gt;昨天周六，在家折腾一天新创意，比如做dota2的赛况的小程序，结果审核不让通过，说需要提供4种”让人生畏”的材料，如下图：&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
  </entry>
  
  <entry>
    <title>推广渠道系列 - 豆瓣帖子</title>
    <link href="http://www.cmlanche.com/2019/06/12/%E6%8E%A8%E5%B9%BF%E6%B8%A0%E9%81%93%E7%B3%BB%E5%88%97---%E8%B1%86%E7%93%A3/"/>
    <id>http://www.cmlanche.com/2019/06/12/推广渠道系列---豆瓣/</id>
    <published>2019-06-12T13:46:10.000Z</published>
    <updated>2019-06-17T01:55:57.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>独立开发者往往都不擅长推广，我也一样，但也得学会做推广，推广是慢慢的事情，无法一气呵成，因为穷。</p><p>在做完zhaozhuji.info这个站点后，发现最终还是得落实到推广上，因此我推出”推广渠道系列”文章，把我遇到的好的推广工具、方式分享出来，供大家参考。</p></blockquote><p>今天分享的是，<strong>豆瓣帖子</strong>。</p><a id="more"></a><p>经常搜索，发现很多内容豆瓣帖子都排在前面。</p><p>举例子：搜索”小众it技术社区”</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/uwxup.png" alt="WX20190612-213514@2x"></p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/fhfn2.png" alt="WX20190612-213533@2x"></p><p>其实内容不多，一个标题还有内容，没有seo的关键字和描述，但是这个页面被百度收录了，通过标题可以搜得到。</p><p>我们不妨效仿一下，在豆瓣上发布你的推广，注重标题和内容，期待它哪一天能够爆发！</p><p>比如我推广我的找主机网</p><p>标题：”2019年阿里云2.4折优惠购买指南”</p><p>内容：”阿里云对中国用户来说是最好的云计算服务厂商了，而它提供的优惠也多种多样，不管对玩主机的新手还是老手，面对各种各样的活动都会陷入眼花缭乱的困境，因此，我专门写一篇文章来给大家抽丝剥茧，详细描绘一下对不同的用户怎么购买主机才是最优惠的。”</p><p>外加一张截图和原文链接，猛戳看效果：<a href="https://www.douban.com/group/topic/143072327/" target="_blank" rel="noopener">https://www.douban.com/group/topic/143072327/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;独立开发者往往都不擅长推广，我也一样，但也得学会做推广，推广是慢慢的事情，无法一气呵成，因为穷。&lt;/p&gt;
&lt;p&gt;在做完zhaozhuji.info这个站点后，发现最终还是得落实到推广上，因此我推出”推广渠道系列”文章，把我遇到的好的推广工具、方式分享出来，供大家参考。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;今天分享的是，&lt;strong&gt;豆瓣帖子&lt;/strong&gt;。&lt;/p&gt;
    
    </summary>
    
      <category term="推广渠道系列" scheme="http://www.cmlanche.com/categories/%E6%8E%A8%E5%B9%BF%E6%B8%A0%E9%81%93%E7%B3%BB%E5%88%97/"/>
    
    
      <category term="推广" scheme="http://www.cmlanche.com/tags/%E6%8E%A8%E5%B9%BF/"/>
    
      <category term="推广渠道" scheme="http://www.cmlanche.com/tags/%E6%8E%A8%E5%B9%BF%E6%B8%A0%E9%81%93/"/>
    
  </entry>
  
  <entry>
    <title>2019年阿里云主机优惠购买指南</title>
    <link href="http://www.cmlanche.com/2019/06/09/2019%E5%B9%B4%E9%98%BF%E9%87%8C%E4%BA%91%E4%B8%BB%E6%9C%BA%E4%BC%98%E6%83%A0%E8%B4%AD%E4%B9%B0%E6%8C%87%E5%8D%97/"/>
    <id>http://www.cmlanche.com/2019/06/09/2019年阿里云主机优惠购买指南/</id>
    <published>2019-06-09T04:03:27.000Z</published>
    <updated>2019-06-09T04:05:27.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>阿里云对中国用户来说是最好的云计算服务厂商了，而它提供的优惠也多种多样，不管对玩主机的新手还是老手，面对各种各样的活动都会陷入眼花缭乱的困境，因此，我专门写一篇文章来给大家抽丝剥茧，详细描绘一下对不同的用户怎么购买主机才是最优惠的。</p></blockquote><h3 id="优惠活动图"><a href="#优惠活动图" class="headerlink" title="优惠活动图"></a>优惠活动图</h3><p>本人是拥有十年程序猿开发经验，大学本科四年，工作6年，软件工程出身，所以我用我们程序猿特有的软件来绘制一个优惠活动图。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-08-095844.jpg?x-oss-process=style/logomark" alt="主机购买指南"></p><p>大概花了半个多小时绘制玩这张活动图 /(ㄒoㄒ)/~~</p><a id="more"></a><h3 id="名词解释："><a href="#名词解释：" class="headerlink" title="名词解释："></a>名词解释：</h3><ol><li>新用户：没注册过阿里云的用户或者注册且实名了但从未购买任何产品的用户</li><li>首购用户：表示已注册并实名认证后但从未购买该产品的用户</li><li>老用户：已实名并购买过该产品的用户</li></ol><h3 id="活动列表："><a href="#活动列表：" class="headerlink" title="活动列表："></a>活动列表：</h3><ol><li><a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=mm1tv2if" target="_blank" rel="noopener">阿里云新用户2000元新手红包</a></li></ol><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/9kvj2.png" alt="image-20190608181007100"></p><ol start="2"><li><a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">阿里云Hi拼团活动</a></li></ol><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/sfxdi.png" alt="image-20190608181153225"></p><ol start="3"><li><a href="https://promotion.aliyun.com/ntms/act/qwbk.html?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">阿里云首购3折活动</a></li></ol><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/resources/ivsc9.png" alt="image-20190608181258721"></p><h3 id="优惠路线"><a href="#优惠路线" class="headerlink" title="优惠路线"></a>优惠路线</h3><ol><li><strong>新用户路线</strong></li></ol><p><a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=mm1tv2if" target="_blank" rel="noopener">领取2000元红包</a> —&gt; 找老用户<a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">开hi拼团活动</a>  —&gt; 2.4折优惠</p><p><a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=mm1tv2if" target="_blank" rel="noopener">领取2000元红包</a> —&gt; 参加首购活动 —&gt; 3折优惠</p><ol start="2"><li><strong>首购用户路线</strong></li></ol><p>找新用户<a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">开hi拼团活动</a> —&gt; 可以找到 —&gt; 2.4折优惠</p><p>找新用户<a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">开hi拼团活动</a> —&gt; 没找到 —&gt; 3折优惠</p><p>参加<a href="https://promotion.aliyun.com/ntms/act/qwbk.html?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">首购活动</a> —&gt; 3折优惠</p><ol start="3"><li><strong>老用户且非首购路线</strong></li></ol><p>找新用户<a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">开hi拼团活动</a> —&gt; 可以找到 —&gt; 2.4折优惠</p><p>找新用户<a href="https://www.aliyun.com/acts/hi-group-buying?source=5176.11533457&amp;userCode=mm1tv2if&amp;type=copy" target="_blank" rel="noopener">开hi拼团活动</a> —&gt; 没找到 —&gt; 直接购买 —&gt; 3折优惠</p><p>花了大概一个多小时认真写了这篇，也是想给自己刚上线的网站【<a href="https://zhaozhuji.info" target="_blank" rel="noopener">zhaozhuji.info</a>】做做推广，谢谢拜访！</p><p>其实做这个图也是得益于我的一个微信群”独立开发者”的，感谢小程序【魅力拍】作者徐玉丰，算也是给他做做推广，感谢他的启发！</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-08-102802.png?x-oss-process=style/logomark" alt="image-20190608182801166"></p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-08-102828.png?x-oss-process=style/logomark" alt="image-20190608182826446"></p><p>原文地址：<a href="https://zhaozhuji.info/post/2019-aliyun-youhui-tips" target="_blank" rel="noopener">https://zhaozhuji.info/post/2019-aliyun-youhui-tips</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;阿里云对中国用户来说是最好的云计算服务厂商了，而它提供的优惠也多种多样，不管对玩主机的新手还是老手，面对各种各样的活动都会陷入眼花缭乱的困境，因此，我专门写一篇文章来给大家抽丝剥茧，详细描绘一下对不同的用户怎么购买主机才是最优惠的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;优惠活动图&quot;&gt;&lt;a href=&quot;#优惠活动图&quot; class=&quot;headerlink&quot; title=&quot;优惠活动图&quot;&gt;&lt;/a&gt;优惠活动图&lt;/h3&gt;&lt;p&gt;本人是拥有十年程序猿开发经验，大学本科四年，工作6年，软件工程出身，所以我用我们程序猿特有的软件来绘制一个优惠活动图。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-06-08-095844.jpg?x-oss-process=style/logomark&quot; alt=&quot;主机购买指南&quot;&gt;&lt;/p&gt;
&lt;p&gt;大概花了半个多小时绘制玩这张活动图 /(ㄒoㄒ)/~~&lt;/p&gt;
    
    </summary>
    
      <category term="主机优惠" scheme="http://www.cmlanche.com/categories/%E4%B8%BB%E6%9C%BA%E4%BC%98%E6%83%A0/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="找主机网" scheme="http://www.cmlanche.com/tags/%E6%89%BE%E4%B8%BB%E6%9C%BA%E7%BD%91/"/>
    
      <category term="阿里云主机优惠" scheme="http://www.cmlanche.com/tags/%E9%98%BF%E9%87%8C%E4%BA%91%E4%B8%BB%E6%9C%BA%E4%BC%98%E6%83%A0/"/>
    
  </entry>
  
  <entry>
    <title>免费logo创建器launchaco</title>
    <link href="http://www.cmlanche.com/2019/05/27/%E5%85%8D%E8%B4%B9logo%E5%88%9B%E5%BB%BA%E5%99%A8launchaco.com/"/>
    <id>http://www.cmlanche.com/2019/05/27/免费logo创建器launchaco.com/</id>
    <published>2019-05-27T04:36:00.000Z</published>
    <updated>2019-05-27T08:25:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天发现一个超级好用，并且免费的logo创建器，<a href="https://www.launchaco.com/" target="_blank" rel="noopener">launchaco.com</a>，之前用过<a href="https://shapefactory.co/" target="_blank" rel="noopener">shapefactory.co</a>，也很好用，但是贵的令人发指，一个做好的logo，需要44美金。而今天发现了<code>launchaco.com</code>，感觉发现了一块宝藏，忍不住想分享。好了，现在来复盘一下整个使用流程。</p><a id="more"></a><p>以我最近正在开发的产品：<strong>找主机 zhaozhuji.info为例</strong></p><h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>打开<a href="https://www.launchaco.com" target="_blank" rel="noopener">launchaco.com</a>官网，选择<code>logo</code>菜单，点击<code>Create Your Logo for Free</code></p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-082526.png?x-oss-process=style/logomark" alt="image-20190527125730237"></p><h3 id="产品取名字"><a href="#产品取名字" class="headerlink" title="产品取名字"></a>产品取名字</h3><p>注意只支持英文字母，不支持中文，这是唯一的瑕疵。而本身这个产品是建立在人工智能上的，中文不仅字体不支持，也不支持含义联想。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-045829.png?x-oss-process=style/logomark" alt="image-20190527125828249"></p><h3 id="选字体"><a href="#选字体" class="headerlink" title="选字体"></a>选字体</h3><p>没三种选一种字体，会让你选择四五次，它是期望发现你的字体爱好！</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-045902.png?x-oss-process=style/logomark" alt="image-20190527125859614"></p><h3 id="选择主题色"><a href="#选择主题色" class="headerlink" title="选择主题色"></a>选择主题色</h3><p>下图中列出了6中不同的主题色，每一种都代表不同的含义，并且明确标出了，请注意看图的下面。</p><p>这里我选择第一种，<code>Friendly, Loyal, &amp; Strong</code>，代表着友好、尊贵、强大。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-050143.png?x-oss-process=style/logomark" alt="image-20190527130141993"></p><p>每种主题色都给你配置好了3种色调，并且标明了适用的含义，是不是很方便啦！</p><p>这里我们选择第三种：<code>Peaceful, Limitless, Tranquil, &amp; Friendly</code></p><h3 id="选择logo"><a href="#选择logo" class="headerlink" title="选择logo"></a>选择logo</h3><p>选择3个你喜欢的logo！</p><p>说真的，这个网站的logo真的超级棒，每个我都很喜欢！</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-050610.gif?x-oss-process=style/logomark" alt="kkkk"></p><h3 id="选择搭配"><a href="#选择搭配" class="headerlink" title="选择搭配"></a>选择搭配</h3><p>最后，系统会根据你的选择，给出一系列智能搭配。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-050927.png?x-oss-process=style/logomark" alt="image-20190527130926493"></p><h3 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存</h3><p>搭配中，随便选一个，然后编辑，然后点击右上角保存！</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-051701.png?x-oss-process=style/logomark" alt="image-20190527131700176"></p><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-051732.png?x-oss-process=style/logomark" alt="image-20190527131731317"></p><p>右上角箭头下载后，你会得到png和svg很多资源，想要的都有了，如下图：</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-052442.png?x-oss-process=style/logomark" alt="image-20190527131839225"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>有没有感觉很方便？关键是免费啊，基本类似的logo maker都收费，难得发现个免费的。后续我会继续发布有助于独立开发者产品开发的工具，关注我公众号及时提醒。</p><p><img src="https://zhaozhuji1.oss-cn-beijing.aliyuncs.com/zhaozhuji/2019-05-27-081921.jpg?x-oss-process=style/logomark" alt="扫码_搜索联合传播样式-微信标准绿版"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天发现一个超级好用，并且免费的logo创建器，&lt;a href=&quot;https://www.launchaco.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;launchaco.com&lt;/a&gt;，之前用过&lt;a href=&quot;https://shapefactory.co/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;shapefactory.co&lt;/a&gt;，也很好用，但是贵的令人发指，一个做好的logo，需要44美金。而今天发现了&lt;code&gt;launchaco.com&lt;/code&gt;，感觉发现了一块宝藏，忍不住想分享。好了，现在来复盘一下整个使用流程。&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者必备产品帮助工具" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85%E5%BF%85%E5%A4%87%E4%BA%A7%E5%93%81%E5%B8%AE%E5%8A%A9%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="logo创建器" scheme="http://www.cmlanche.com/tags/logo%E5%88%9B%E5%BB%BA%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>独立开发者的觉悟</title>
    <link href="http://www.cmlanche.com/2019/05/20/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85%E5%BF%85%E9%A1%BB%E8%A6%81%E6%9C%89%E4%BB%98%E5%87%BA%E6%88%90%E5%80%8D%E5%8A%AA%E5%8A%9B%E6%89%8D%E8%83%BD%E6%88%90%E5%8A%9F%E7%9A%84%E8%A7%89%E6%82%9F/"/>
    <id>http://www.cmlanche.com/2019/05/20/独立开发者必须要有付出成倍努力才能成功的觉悟/</id>
    <published>2019-05-20T04:44:55.000Z</published>
    <updated>2019-05-20T05:17:58.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/gko5e.png" alt="image-20190520130055901"></p><p>经常会做梦，我能躺着挣钱吗？</p><p>作为一穷二白的白丁来讲，这只能做梦了。</p><p>做任何一个产品，都需要花心血去维护运营的。</p><p>不管这个产品是需要怎样的劳动，是轻工具型，还是重内容型，都需要长时间的专注努力，才可能达到你想要的成功。</p><a id="more"></a><p>如果你发现你的产品更新迭代速度很慢，每次更新都要耗费很大的精力，那么请改进迭代流程，用技术手段提高更新效率。</p><p>如果你发现你的产品的访客如流水般，来也快去也快，那就请把产品做得更好，增强用户粘性，让用户一看到你的产品，就欢喜的不得了。小水管一般的流量，用竹篮子如何能装得下？请记住，这样的产品再好的推广也无济于事！</p><p>当然这是目前我出现的问题，所以我才得以轻松说出口，我也会努力做到这两条。</p><p>独立开发者应该要有觉悟，不管产品简单还是复杂，它就像你的孩子，必须得用心呵护和照料，必须的付出成倍的努力才能茁壮成长！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/gko5e.png&quot; alt=&quot;image-20190520130055901&quot;&gt;&lt;/p&gt;
&lt;p&gt;经常会做梦，我能躺着挣钱吗？&lt;/p&gt;
&lt;p&gt;作为一穷二白的白丁来讲，这只能做梦了。&lt;/p&gt;
&lt;p&gt;做任何一个产品，都需要花心血去维护运营的。&lt;/p&gt;
&lt;p&gt;不管这个产品是需要怎样的劳动，是轻工具型，还是重内容型，都需要长时间的专注努力，才可能达到你想要的成功。&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="觉悟" scheme="http://www.cmlanche.com/tags/%E8%A7%89%E6%82%9F/"/>
    
  </entry>
  
  <entry>
    <title>购买阿里云遇到Permission denied的问题</title>
    <link href="http://www.cmlanche.com/2019/05/15/%E8%B4%AD%E4%B9%B0%E9%98%BF%E9%87%8C%E4%BA%91%E9%81%87%E5%88%B0Permission-denied%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://www.cmlanche.com/2019/05/15/购买阿里云遇到Permission-denied的问题/</id>
    <published>2019-05-15T13:24:11.000Z</published>
    <updated>2019-05-15T13:33:49.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近我的新项目友链联盟<a href="https://youlianplus.com" target="_blank" rel="noopener">youlianplus.com</a>项目即将完成，准备拿到阿里云试试，在阿里云华北3购买了一台迷你服务器，1核1g40g硬盘，打算测试一下。</p><p>买了之后，准备用ssh登录进去，结果出现了个<code>permission denied</code>权限被拒绝的问题，详情如下：</p><a id="more"></a><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chengmingdeMacBook-Pro:blog cmlanche$ ssh root@47.92.24.241</span><br><span class="line">The authenticity of host '47.92.24.241 (47.92.24.241)' can't be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:PYBgUIuFIYcBUCzUGG0qLJDGH2At/dQ+zk+Q9tyX7+E.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added '47.92.24.241' (ECDSA) to the list of known hosts.</span><br><span class="line">Permission denied (publickey).</span><br><span class="line">chengmingdeMacBook-Pro:blog cmlanche$ ssh root@47.92.24.241</span><br><span class="line">Permission denied (publickey).</span><br><span class="line">chengmingdeMacBook-Pro:blog cmlanche$ ssh root@47.92.24.241</span><br><span class="line">Permission denied (publickey).</span><br></pre></td></tr></table></figure><p>意思是说，无法用publickey来登录服务器，那问题肯定出在服务器那边的配置上了，百度找了个解决办法，有效！<a href="https://blog.csdn.net/wtopps/article/details/79449920" target="_blank" rel="noopener">https://blog.csdn.net/wtopps/article/details/79449920</a></p><p>幸好阿里云控制台界面有一个远程连接的控制，通过这个入口进去，可以直接登录。</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/1n9wu.png" alt="image-20190515213018736"></p><p>进去后，注意要保存好连接码，这个码只会出现一次！就保存在你电脑中就好了。</p><p>关键步骤：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>修改PasswordAuthentication的值为yes，注意把签名的#去掉</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure><p>上文连接说要重启httpd服务，其实没啥作用，咱们来硬的，直接重启服务器就好了！</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/pbyme.png" alt="image-20190515213333642"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近我的新项目友链联盟&lt;a href=&quot;https://youlianplus.com&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;youlianplus.com&lt;/a&gt;项目即将完成，准备拿到阿里云试试，在阿里云华北3购买了一台迷你服务器，1核1g40g硬盘，打算测试一下。&lt;/p&gt;
&lt;p&gt;买了之后，准备用ssh登录进去，结果出现了个&lt;code&gt;permission denied&lt;/code&gt;权限被拒绝的问题，详情如下：&lt;/p&gt;
    
    </summary>
    
      <category term="阿里云" scheme="http://www.cmlanche.com/categories/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    
      <category term="阿里云" scheme="http://www.cmlanche.com/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
  </entry>
  
  <entry>
    <title>springboot项目部署到ubuntu18.04的过程，http跳转https，使用acme.sh安装证书</title>
    <link href="http://www.cmlanche.com/2019/05/14/springboot-ubuntu-https/"/>
    <id>http://www.cmlanche.com/2019/05/14/springboot-ubuntu-https/</id>
    <published>2019-05-14T10:33:53.000Z</published>
    <updated>2019-05-14T11:49:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近开发的友链联盟项目即将”竣工”，准备拿到公有云Ubuntu是测试下，想要达到的理想状态有如下几点：</p><ol><li>端口保持9090，发布spring boot的jar包，后台运行</li><li>nginx部署，强制https访问应用</li><li>使用<a href="https://github.com/Neilpang/acme.sh" target="_blank" rel="noopener">acme.sh</a>来生成、安装ssl证书</li><li>开启防火墙，打开80、443端口，关闭9090端口(避免直接访问9090打开应用)</li></ol><a id="more"></a><p>目前已经完成上面的要求，可以尝试访问<a href="http://sitefriendlinks.com" target="_blank" rel="noopener">http://sitefriendlinks.com</a>、<a href="http://sitefriendlinks.com:9090" target="_blank" rel="noopener">http://sitefriendlinks.com:9090</a>，前者会强制跳转到<a href="https://sitefriendlinks.com" target="_blank" rel="noopener">https://sitefriendlinks.com</a>，后者无法打开。</p><h3 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h3><ol><li><p>nginx</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt install nginx</span><br></pre></td></tr></table></figure><p>安装后自动就启动了，你可以用如下命令进行开启和关闭：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">service nginx stop</span><br><span class="line">service nginx start</span><br><span class="line">service nginx restart # 重启</span><br></pre></td></tr></table></figure></li><li><p>mysql</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">apt install mysql-server</span><br></pre></td></tr></table></figure><p>详情请看：<a href="https://www.jianshu.com/p/3821c2603b92" target="_blank" rel="noopener">https://www.jianshu.com/p/3821c2603b92</a></p><p>需要注意修改root密码：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">show databases；</span><br><span class="line"> </span><br><span class="line">use mysql;</span><br><span class="line">  </span><br><span class="line">update user set authentication_string=PASSWORD("yourpassword") where user='root';</span><br><span class="line">  </span><br><span class="line">update user set plugin="mysql_native_password";</span><br><span class="line">  </span><br><span class="line">flush privileges;</span><br><span class="line">  </span><br><span class="line">quit;</span><br></pre></td></tr></table></figure></li><li><p>java 8</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">apt install openjdk-8-jre-headless</span><br></pre></td></tr></table></figure><p><a href="[https://www.centos.bz/2018/06/%E5%9C%A8ubuntu-18-04%E4%B8%8A%E4%BD%BF%E7%94%A8apt%E5%AE%89%E8%A3%85java/](https://www.centos.bz/2018/06/在ubuntu-18-04上使用apt安装java/">参考链接</a>)</p></li></ol><h3 id="部署nginx"><a href="#部署nginx" class="headerlink" title="部署nginx"></a>部署nginx</h3><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  sitefriendlinks.com;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^(.*)$</span> https://<span class="variable">$host</span><span class="variable">$1</span> <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">443</span>;</span><br><span class="line">        <span class="attribute">server_name</span>  sitefriendlinks.com;</span><br><span class="line">        <span class="attribute">ssl</span>          <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">ssl_certificate</span> /etc/nginx/ssl/fullchain.cer;</span><br><span class="line">        <span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl/sitefriendlinks.com.key;</span><br><span class="line">        <span class="attribute">ssl_session_timeout</span> <span class="number">5m</span>;</span><br><span class="line">        <span class="attribute">ssl_protocols</span> TLSv1;</span><br><span class="line">        <span class="attribute">ssl_ciphers</span>  HIGH:!aNULL:!MD5;</span><br><span class="line">        <span class="attribute">ssl_prefer_server_ciphers</span>   <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="attribute">proxy_pass</span>              http://localhost:9090/;</span><br><span class="line">            <span class="attribute">proxy_set_header</span>        Host <span class="variable">$host</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span>        X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span>        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span>        X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">            <span class="attribute">proxy_set_header</span>        X-Forwarded-Port <span class="variable">$server_port</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用acem-sh安装证书"><a href="#使用acem-sh安装证书" class="headerlink" title="使用acem.sh安装证书"></a>使用acem.sh安装证书</h3><p>参考文档：<a href="https://github.com/Neilpang/acme.sh/wiki/说明" target="_blank" rel="noopener">https://github.com/Neilpang/acme.sh/wiki/%E8%AF%B4%E6%98%8E</a></p><p>关键步骤：</p><ol><li>创建别名</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">alias acme.sh=~/.acme.sh/acme.sh</span><br></pre></td></tr></table></figure><ol start="2"><li>生成证书</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">acme.sh --issue  -d mydomain.com   --nginx</span><br></pre></td></tr></table></figure><ol start="3"><li>安装证书</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">acme.sh  --installcert  -d  &lt;domain&gt;.com   \</span><br><span class="line">        --key-file   /etc/nginx/ssl/&lt;domain&gt;.key \</span><br><span class="line">        --fullchain-file /etc/nginx/ssl/fullchain.cer \</span><br><span class="line">        --reloadcmd  "service nginx force-reload"</span><br></pre></td></tr></table></figure><p><strong>注意，你需要手动创建/etc/nginx/ssl目录，不如上面的安装命令会报路径错误</strong></p><p>此时，你已经能正常用https打开你的网站了</p><h3 id="打开防火墙"><a href="#打开防火墙" class="headerlink" title="打开防火墙"></a>打开防火墙</h3><p>Ubuntu的防火墙命令是ufw，参考：<a href="https://www.cnblogs.com/yuanlipu/p/7103740.html" target="_blank" rel="noopener">https://www.cnblogs.com/yuanlipu/p/7103740.html</a></p><p>先查询下防火墙是否打开：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure><p>如果没打开，则开启防火墙</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ufw enable</span><br></pre></td></tr></table></figure><p>默认情况下，防火墙是会把所有端口都关闭的，不允许外界访问，但是我们要做三件事：开启80、443端口，关闭9090端口</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo ufw allow 80</span><br><span class="line">sudo ufw allow 443</span><br><span class="line">sudo ufw deny 9090</span><br></pre></td></tr></table></figure><p>此时，咱们的服务器会变的非常安全，注意哦，因为没打开3306端口，所以你的数据库是无法远程访问的，如需要则打开3306端口即可。</p><h3 id="后台运行spring-boot工程"><a href="#后台运行spring-boot工程" class="headerlink" title="后台运行spring boot工程"></a>后台运行spring boot工程</h3><p>把打包好的jar包发到服务器（通常用scp命令即可），然后执行如下命令即可后台启动：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nohup java -jar sitefriendlinks.jar &gt;&gt; ./output.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><hr><p>ok，部署完成！</p><p>by <a href="https://cmlanche.com" target="_blank" rel="noopener">cmlanche.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近开发的友链联盟项目即将”竣工”，准备拿到公有云Ubuntu是测试下，想要达到的理想状态有如下几点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;端口保持9090，发布spring boot的jar包，后台运行&lt;/li&gt;
&lt;li&gt;nginx部署，强制https访问应用&lt;/li&gt;
&lt;li&gt;使用&lt;a href=&quot;https://github.com/Neilpang/acme.sh&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;acme.sh&lt;/a&gt;来生成、安装ssl证书&lt;/li&gt;
&lt;li&gt;开启防火墙，打开80、443端口，关闭9090端口(避免直接访问9090打开应用)&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="部署" scheme="http://www.cmlanche.com/categories/%E9%83%A8%E7%BD%B2/"/>
    
    
      <category term="springboot" scheme="http://www.cmlanche.com/tags/springboot/"/>
    
      <category term="https" scheme="http://www.cmlanche.com/tags/https/"/>
    
      <category term="ssl" scheme="http://www.cmlanche.com/tags/ssl/"/>
    
      <category term="ubuntu" scheme="http://www.cmlanche.com/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>图文详解如何修改git已提交记录的邮箱？</title>
    <link href="http://www.cmlanche.com/2019/05/13/%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9git%E5%B7%B2%E6%8F%90%E4%BA%A4%E8%AE%B0%E5%BD%95%E7%9A%84%E9%82%AE%E7%AE%B1%EF%BC%9F/"/>
    <id>http://www.cmlanche.com/2019/05/13/如何修改git已提交记录的邮箱？/</id>
    <published>2019-05-13T03:26:12.000Z</published>
    <updated>2019-05-13T04:51:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>有时候，公司提交的代码必须使用公司邮箱，而你误操作，直接把自己个人邮箱提交上去了，此时你就会遇到这样的需求：如何修改git已提交的邮箱？</p><p>而这个需求对于新手来说，往往要花费半天的时间才能理解修改过程，简直太傻比了，所以我这里做一个详细的文档来帮助自己和你搞清楚这个流程。尤其要理解变基，它不是一个命令执行就完成了，而是一连串命令的组合。</p><a id="more"></a><h3 id="变基"><a href="#变基" class="headerlink" title="变基"></a>变基</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rebase -i</span><br></pre></td></tr></table></figure><p>执行后，会打开最近一条的提交记录，当然上面的命令可以指定某一条记录，命令是：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git rebase -i &quot;your commit id&quot;</span><br></pre></td></tr></table></figure><p>对于sourcetree用户来说，commit id是SHA-1，可以右键某条提交记录，选择菜单”复制SHA-1到剪贴板”，如下图：</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/mfl1f.png" alt="image-20190513113342522"></p><p>变基rebase命令执行完成后，会打印<strong>类似</strong>如下内容：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pick bd81df5 更新API</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> Rebase abcb9d0..bd81df5 onto abcb9d0 (1 command)</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> Commands:</span><br><span class="line"><span class="meta">#</span> p, pick = use commit</span><br><span class="line"><span class="meta">#</span> r, reword = use commit, but edit the commit message</span><br><span class="line"><span class="meta">#</span> e, edit = use commit, but stop for amending</span><br><span class="line"><span class="meta">#</span> s, squash = use commit, but meld into previous commit</span><br><span class="line"><span class="meta">#</span> f, fixup = like "squash", but discard this commit's log message</span><br><span class="line"><span class="meta">#</span> x, exec = run command (the rest of the line) using shell</span><br><span class="line"><span class="meta">#</span> d, drop = remove commit</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> These lines can be re-ordered; they are executed from top to bottom.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> If you remove a line here THAT COMMIT WILL BE LOST.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> However, if you remove everything, the rebase will be aborted.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> Note that empty commits are commented out</span><br></pre></td></tr></table></figure><p>新手往往会一脸懵逼，不止所错，此时是在rebase的过程中，你需要把pick改为edit，如下：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">edit bd81df5 更新API</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> Rebase abcb9d0..bd81df5 onto abcb9d0 (1 command)</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> Commands:</span><br><span class="line"><span class="meta">#</span> p, pick = use commit</span><br><span class="line"><span class="meta">#</span> r, reword = use commit, but edit the commit message</span><br><span class="line"><span class="meta">#</span> e, edit = use commit, but stop for amending</span><br><span class="line"><span class="meta">#</span> s, squash = use commit, but meld into previous commit</span><br><span class="line"><span class="meta">#</span> f, fixup = like "squash", but discard this commit's log message</span><br><span class="line"><span class="meta">#</span> x, exec = run command (the rest of the line) using shell</span><br><span class="line"><span class="meta">#</span> d, drop = remove commit</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> These lines can be re-ordered; they are executed from top to bottom.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> If you remove a line here THAT COMMIT WILL BE LOST.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> However, if you remove everything, the rebase will be aborted.</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> Note that empty commits are commented out</span><br></pre></td></tr></table></figure><p>更改完成后，保存并退出vi编辑器：<code>:wq</code></p><p>然后会打印这样的消息：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chengmingdeMacBook-Pro:server cmlanche$ git rebase -i "abcb9d0d1e99cdad25d8d08119e494436b000e59"</span><br><span class="line">Stopped at bd81df5...  更新API</span><br><span class="line">You can amend the commit now, with</span><br><span class="line"></span><br><span class="line">  git commit --amend </span><br><span class="line"></span><br><span class="line">Once you are satisfied with your changes, run</span><br><span class="line"></span><br><span class="line">  git rebase --continue</span><br><span class="line">chengmingdeMacBook-Pro:server cmlanche$</span><br></pre></td></tr></table></figure><p>给大家先科普一下这个<code>amend</code>英文单词，是修改的意思，对我来说好陌生，为啥不用change或者fix之类的。</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/qgjur.png" alt="image-20190513114137949"></p><p>上面的信息说了，如果你要amend，也就是要修改这个提交的话，那么用</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><p>如果你对这次修改满意的话，就用如下命令结束此次变基</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git rebase --continue</span><br></pre></td></tr></table></figure><h3 id="重置账户邮箱信息"><a href="#重置账户邮箱信息" class="headerlink" title="重置账户邮箱信息"></a>重置账户邮箱信息</h3><p>我们当然要修改啦，那么执行如下命令，重置提交的账户信息：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit --amend --author="cmlanche &lt;1204833748@qq.com&gt;" --no-edit</span><br></pre></td></tr></table></figure><p>同事，要注意你的sourcetree，出现了新情况！</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/8w5dw.png" alt="image-20190513114851415"></p><p>我们可以看到一个新的提交，并且，邮箱账号都经过了修改，如果你去掉<code>--no-edit</code>还可以修改commit message，也就是图中的”更新API”，举栗子吧，我可以继续用amend修改此次变基</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit --amend --author="cmlanche &lt;1204833748@qq.com&gt;"</span><br></pre></td></tr></table></figure><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/5500p.png" alt="image-20190513115132114"></p><p>保存退出vi编辑器，看sourcetree咋样了：</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/e0x3u.png" alt="image-20190513115216969"></p><p>真的很完美，接下来就是合并了，退出变基。</p><h3 id="退出变基"><a href="#退出变基" class="headerlink" title="退出变基"></a>退出变基</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git rebase --continue</span><br></pre></td></tr></table></figure><p>在控制台中打印如上命令退出变基，我们看到退出变基也就是使用最新的修改了，就一条分支了。</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chengmingdeMacBook-Pro:server cmlanche$ git rebase --continue</span><br><span class="line">Successfully rebased and updated refs/heads/bulma.</span><br></pre></td></tr></table></figure><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/4e46r.png" alt="image-20190513115442779"></p><h3 id="最后总结一下"><a href="#最后总结一下" class="headerlink" title="最后总结一下"></a>最后总结一下</h3><p>变基真的很有用，他不是一条命令搞定的，是一个过程，就像变成中打开了一个输入流，最后用完你得关闭输入流一样。</p><p>通过变基你可以轻松实现提交信息的任意重新修改！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有时候，公司提交的代码必须使用公司邮箱，而你误操作，直接把自己个人邮箱提交上去了，此时你就会遇到这样的需求：如何修改git已提交的邮箱？&lt;/p&gt;
&lt;p&gt;而这个需求对于新手来说，往往要花费半天的时间才能理解修改过程，简直太傻比了，所以我这里做一个详细的文档来帮助自己和你搞清楚这个流程。尤其要理解变基，它不是一个命令执行就完成了，而是一连串命令的组合。&lt;/p&gt;
    
    </summary>
    
      <category term="日常技术" scheme="http://www.cmlanche.com/categories/%E6%97%A5%E5%B8%B8%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="git" scheme="http://www.cmlanche.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>改造思寒的AppCrawler，使其支持Appium最新版本</title>
    <link href="http://www.cmlanche.com/2019/05/08/%E6%94%B9%E9%80%A0%E6%80%9D%E5%AF%92%E7%9A%84AppiumCrawler%EF%BC%8C%E4%BD%BF%E5%85%B6%E6%94%AF%E6%8C%81Appium%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC/"/>
    <id>http://www.cmlanche.com/2019/05/08/改造思寒的AppiumCrawler，使其支持Appium最新版本/</id>
    <published>2019-05-08T03:19:06.000Z</published>
    <updated>2019-05-08T05:01:35.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="思绪"><a href="#思绪" class="headerlink" title="思绪"></a>思绪</h3><p>最近完成了自定义Appium的需求，让Appium内置了自动识别权限框并点击的能力，参考我的知乎专栏：<a href="https://zhuanlan.zhihu.com/custom-appium" target="_blank" rel="noopener">自定义Appium之路</a></p><p>但遇到另外一个问题，就是testerhome思寒开发的AppiumCrawler并不支持Appium最新版，也就是当前的1.12版本，只支持到1.8版本，让人很是捉急。</p><p>本来是想基于1.8重新自定义一个appium，但是发现这个appium实在太老了，下载下来编译都有各种问题，况且后续还要自定义appium-android-driver，appium-uiautomator2-driver和appium-uiaumator2-server，工作量至少得3天，太费时间。</p><p>索性，我来替思寒把AppCrawler来升级一下，让它支持最新appium。</p><p>刚开始觉得挺难的，毕竟我对scala只略知一二，编译打包方面还要学，但事后发现，这个工程做的确实不错，升级改造过程比预计的要简单很多，这里要给思寒大佬一个赞👍！</p><a id="more"></a><h3 id="改造"><a href="#改造" class="headerlink" title="改造"></a>改造</h3><h4 id="先看看出了什么问题？"><a href="#先看看出了什么问题？" class="headerlink" title="先看看出了什么问题？"></a>先看看出了什么问题？</h4><p>我开启最新的appium：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">appium</span><br></pre></td></tr></table></figure><p>执行appcrawler测试：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -jar appcrawler-2.1.3.jar -a ApiDemos-debug.apk</span><br></pre></td></tr></table></figure><p>执行过程中在appium和appcrawler两端都报错：</p><figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">[HTTP] &lt;-- GET /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/window/rect <span class="number">200</span> <span class="number">7</span> ms - <span class="number">50</span></span><br><span class="line">[HTTP] </span><br><span class="line">[HTTP] --&gt; POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync</span><br><span class="line">[HTTP] &#123;<span class="string">"script"</span>:<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,<span class="string">"args"</span>:[]&#125;</span><br><span class="line">[debug] [W3C (efdf97d8)] Calling AppiumDriver<span class="variable">.execute</span>() <span class="keyword">with</span> args: [<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,[],<span class="string">"efdf97d8-cf46-4ffb-b2d4-7d8feb931cee"</span>]</span><br><span class="line">[debug] [W3C (efdf97d8)] Encountered internal error running command: NotImplementedError: Method is <span class="keyword">not</span> implemented</span><br><span class="line">[debug] [W3C (efdf97d8)]     at AndroidDriver<span class="variable">.extensions</span><span class="variable">.execute</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-android-driver/lib/commands/execute<span class="variable">.js</span>:<span class="number">12</span>:<span class="number">9</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at curCommandCancellable<span class="variable">._bluebird</span><span class="variable">.default</span><span class="variable">.resolve</span><span class="variable">.then</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/lib/basedriver/driver<span class="variable">.js</span>:<span class="number">291</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryCatcher (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/util<span class="variable">.js</span>:<span class="number">26</span>:<span class="number">23</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseFromHandler</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">510</span>:<span class="number">31</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAt</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">584</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAtPostResolution</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">248</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueue</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">128</span>:<span class="number">12</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">133</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Immediate<span class="variable">.Async</span><span class="variable">.drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">15</span>:<span class="number">14</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at runCallback (timers<span class="variable">.js</span>:<span class="number">705</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryOnImmediate (timers<span class="variable">.js</span>:<span class="number">676</span>:<span class="number">5</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at processImmediate (timers<span class="variable">.js</span>:<span class="number">658</span>:<span class="number">5</span>)</span><br><span class="line">[HTTP] &lt;-- POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync <span class="number">405</span> <span class="number">11</span> ms - <span class="number">1600</span></span><br><span class="line">[HTTP] </span><br><span class="line">[HTTP] --&gt; POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync</span><br><span class="line">[HTTP] &#123;<span class="string">"script"</span>:<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,<span class="string">"args"</span>:[]&#125;</span><br><span class="line">[debug] [W3C (efdf97d8)] Calling AppiumDriver<span class="variable">.execute</span>() <span class="keyword">with</span> args: [<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,[],<span class="string">"efdf97d8-cf46-4ffb-b2d4-7d8feb931cee"</span>]</span><br><span class="line">[debug] [W3C (efdf97d8)] Encountered internal error running command: NotImplementedError: Method is <span class="keyword">not</span> implemented</span><br><span class="line">[debug] [W3C (efdf97d8)]     at AndroidDriver<span class="variable">.extensions</span><span class="variable">.execute</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-android-driver/lib/commands/execute<span class="variable">.js</span>:<span class="number">12</span>:<span class="number">9</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at curCommandCancellable<span class="variable">._bluebird</span><span class="variable">.default</span><span class="variable">.resolve</span><span class="variable">.then</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/lib/basedriver/driver<span class="variable">.js</span>:<span class="number">291</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryCatcher (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/util<span class="variable">.js</span>:<span class="number">26</span>:<span class="number">23</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseFromHandler</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">510</span>:<span class="number">31</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAt</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">584</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAtPostResolution</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">248</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueue</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">128</span>:<span class="number">12</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">133</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Immediate<span class="variable">.Async</span><span class="variable">.drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">15</span>:<span class="number">14</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at runCallback (timers<span class="variable">.js</span>:<span class="number">705</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryOnImmediate (timers<span class="variable">.js</span>:<span class="number">676</span>:<span class="number">5</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at processImmediate (timers<span class="variable">.js</span>:<span class="number">658</span>:<span class="number">5</span>)</span><br><span class="line">[HTTP] &lt;-- POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync <span class="number">405</span> <span class="number">4</span> ms - <span class="number">1600</span></span><br><span class="line">[HTTP] </span><br><span class="line">[HTTP] --&gt; POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync</span><br><span class="line">[HTTP] &#123;<span class="string">"script"</span>:<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,<span class="string">"args"</span>:[]&#125;</span><br><span class="line">[debug] [W3C (efdf97d8)] Calling AppiumDriver<span class="variable">.execute</span>() <span class="keyword">with</span> args: [<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,[],<span class="string">"efdf97d8-cf46-4ffb-b2d4-7d8feb931cee"</span>]</span><br><span class="line">[debug] [W3C (efdf97d8)] Encountered internal error running command: NotImplementedError: Method is <span class="keyword">not</span> implemented</span><br><span class="line">[debug] [W3C (efdf97d8)]     at AndroidDriver<span class="variable">.extensions</span><span class="variable">.execute</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-android-driver/lib/commands/execute<span class="variable">.js</span>:<span class="number">12</span>:<span class="number">9</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at curCommandCancellable<span class="variable">._bluebird</span><span class="variable">.default</span><span class="variable">.resolve</span><span class="variable">.then</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/lib/basedriver/driver<span class="variable">.js</span>:<span class="number">291</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryCatcher (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/util<span class="variable">.js</span>:<span class="number">26</span>:<span class="number">23</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseFromHandler</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">510</span>:<span class="number">31</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAt</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">584</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Promise<span class="variable">._settlePromiseAtPostResolution</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/promise<span class="variable">.js</span>:<span class="number">248</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueue</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">128</span>:<span class="number">12</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Async<span class="variable">._drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">133</span>:<span class="number">10</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at Immediate<span class="variable">.Async</span><span class="variable">.drainQueues</span> (/usr/<span class="keyword">local</span>/lib/node_modules/appium/node_modules/appium-base-driver/node_modules/bluebird/js/main/async<span class="variable">.js</span>:<span class="number">15</span>:<span class="number">14</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at runCallback (timers<span class="variable">.js</span>:<span class="number">705</span>:<span class="number">18</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at tryOnImmediate (timers<span class="variable">.js</span>:<span class="number">676</span>:<span class="number">5</span>)</span><br><span class="line">[debug] [W3C (efdf97d8)]     at processImmediate (timers<span class="variable">.js</span>:<span class="number">658</span>:<span class="number">5</span>)</span><br><span class="line">[HTTP] &lt;-- POST /wd/hub/session/efdf97d8-cf46-<span class="number">4</span>ffb-b2d4-<span class="number">7</span>d8feb931cee/execute/sync <span class="number">405</span> <span class="number">9</span> ms - <span class="number">1600</span></span><br><span class="line">[HTTP]</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> WARN [AppiumClient.$anonfun$getPageSource$<span class="number">1.340</span>] get page source error</span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> WARN [Crawler.refreshPage.562] page source get fail, go back</span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.setElementAction.660] set action to back</span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.runStartupScript.236] first refresh</span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.976] current element = _startupActions-Start-<span class="number">0</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.977] current index = <span class="number">0</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.978] current action = </span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.979] current url = </span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.980] current xpath = startupActions-Start-<span class="number">0</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.981] current tag path = _startupActions-Start-<span class="number">0</span></span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.982] current file name = _</span><br><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">34</span>:<span class="number">01</span> INFO [Crawler.doElementAction.983] current uri = startupActions-Start-<span class="number">0</span>startupActions</span><br><span class="line">Exception in thread <span class="string">"main"</span> java.util.NoSuchElementException: last of empty ListBuffer</span><br><span class="line">at scala.collection.mutable.ListBuffer.last(ListBuffer.scala:<span class="number">401</span>)</span><br><span class="line">at com.testerhome.appcrawler.DataRecord.last(DataRecord.scala:<span class="number">40</span>)</span><br><span class="line">at com.testerhome.appcrawler.Crawler.doElementAction(Crawler.scala:<span class="number">985</span>)</span><br><span class="line">at com.testerhome.appcrawler.Crawler.runStartupScript(Crawler.scala:<span class="number">238</span>)</span><br><span class="line">at com.testerhome.appcrawler.Crawler.start(Crawler.scala:<span class="number">152</span>)</span><br><span class="line">at com.testerhome.appcrawler.AppCrawler$.startCrawl(AppCrawler.scala:<span class="number">344</span>)</span><br><span class="line">at com.testerhome.appcrawler.AppCrawler$.parseParams(AppCrawler.scala:<span class="number">312</span>)</span><br><span class="line">at com.testerhome.appcrawler.AppCrawler$.main(AppCrawler.scala:<span class="number">92</span>)</span><br><span class="line">at com.testerhome.appcrawler.AppCrawler.main(AppCrawler.scala)</span><br></pre></td></tr></table></figure><h4 id="分析原因"><a href="#分析原因" class="headerlink" title="分析原因"></a>分析原因</h4><p>我们看到Appcrawler中报了个<code>get page source error</code>，我们追查appcrawler的代码发现是在这里报错的：</p><figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">getPageSource</span></span>(): <span class="type">String</span> = &#123;</span><br><span class="line">    currentPageSource=<span class="literal">null</span></span><br><span class="line">    currentPageDom=<span class="literal">null</span></span><br><span class="line">    log.info(<span class="string">"start to get page source from appium"</span>)</span><br><span class="line">    <span class="comment">//获取页面结构, 最多重试3次</span></span><br><span class="line">    <span class="number">1</span> to <span class="number">3</span> foreach (i =&gt; &#123;</span><br><span class="line">      asyncTask(<span class="number">20</span>)(driver.getPageSource) <span class="keyword">match</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Some</span>(v) =&gt; &#123;</span><br><span class="line">          log.trace(<span class="string">"get page source success"</span>)</span><br><span class="line">          <span class="comment">//todo: wda返回的不是标准的xml</span></span><br><span class="line">          <span class="keyword">val</span> xmlStr=v <span class="keyword">match</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> json <span class="keyword">if</span> json.trim.charAt(<span class="number">0</span>)=='&#123;' =&gt; &#123;</span><br><span class="line">              log.info(<span class="string">"json format maybe from wda"</span>)</span><br><span class="line">              <span class="type">DataObject</span>.fromJson[<span class="type">Map</span>[<span class="type">String</span>, <span class="type">String</span>]](v).getOrElse(<span class="string">"value"</span>, <span class="string">""</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> xml <span class="keyword">if</span> xml.trim.charAt(<span class="number">0</span>)=='&lt;' =&gt;&#123;</span><br><span class="line">              log.info(<span class="string">"xml format "</span>)</span><br><span class="line">              xml</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="type">Try</span>(<span class="type">XPathUtil</span>.toDocument(xmlStr)) <span class="keyword">match</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="type">Success</span>(v) =&gt; &#123;</span><br><span class="line">              currentPageDom = v</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="type">Failure</span>(e) =&gt; &#123;</span><br><span class="line">              log.warn(<span class="string">"convert to xml fail"</span>)</span><br><span class="line">              log.warn(xmlStr)</span><br><span class="line">              currentPageDom=<span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          currentPageSource = <span class="type">XPathUtil</span>.toPrettyXML(xmlStr)</span><br><span class="line">          <span class="keyword">return</span> currentPageSource</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">None</span> =&gt; &#123;</span><br><span class="line">          log.warn(<span class="string">"get page source error"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    currentPageSource</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>我们看appium的源码，发现在appcrawler给我们的appium传递了一段js代码来获取控件树</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">"script"</span>:<span class="string">"var source = document.documentElement.outerHTML; \nif (!source) &#123; source = new XMLSerializer().serializeToString(document); &#125;\nreturn source;"</span>,<span class="attr">"args"</span>:[]&#125;</span><br></pre></td></tr></table></figure><p>然而，我们的appium代码对get page source这个功能接口做了限制，源码在<code>appium-android-driver</code>中的lib/execute.js中：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">extensions.execute = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span> (<span class="params">script, args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (script.match(<span class="regexp">/^mobile:/</span>)) &#123;</span><br><span class="line">    script = script.replace(<span class="regexp">/^mobile:/</span>, <span class="string">''</span>).trim();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.executeMobile(script, _.isArray(args) ? args[<span class="number">0</span>] : args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> errors.NotImplementedError();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>我们可以看到，这里抛出异常了，说明可能是接口变动了，那么我这里有个大胆猜想，appcrawler所使用的java-client过老。</p><h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4><p>ok，立马开始行动，替换上最新的java-client，也就是7.0，同时我们使用最新的appcrawler2.4.0</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.appium<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>v7.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>同时添加对应的仓库：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>jitpack.io<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://jitpack.io<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br></pre></td></tr></table></figure><p>打包</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mvn assembly:assembly</span><br></pre></td></tr></table></figure><p>打包完成，会再target目录下生成一个完整依赖的jar包：<code>appcrawler-2.4.0-jar-with-dependencies.jar</code></p><p>重新执行，你会发现美妙的事情发生，最新appium完美支持！</p><h4 id="提出质疑"><a href="#提出质疑" class="headerlink" title="提出质疑"></a>提出质疑</h4><p>上面的完美支持，是不是因为我更新了最新版本2.4.0，而不是使用的最开始的2.1.3版本呢？</p><p>有可能！！！</p><p>撤销修改，直接打包2.4.0，执行测试看是否正常。</p><p>结果就是：最开始的get page source问题没了，但出现另外一个问题：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">2019</span>-<span class="number">05</span>-<span class="number">08</span> <span class="number">11</span>:<span class="number">55</span>:<span class="number">46</span> INFO [AppiumClient.30.initLog] already exist</span><br><span class="line">Exception in thread <span class="string">"main"</span> scala.MatchError: [app, appium, deviceName, dontStopAppOnReset, fullReset, noReset] (of <span class="class"><span class="keyword">class</span> <span class="title">java</span>.<span class="title">util</span>.<span class="title">Collections</span>$<span class="title">UnmodifiableSet</span>)</span></span><br><span class="line">        at com.testerhome.appcrawler.driver.AppiumClient.appium(AppiumClient.scala:94)</span><br><span class="line">        at com.testerhome.appcrawler.driver.AppiumClient.&lt;init&gt;(AppiumClient.scala:<span class="number">40</span>)</span><br><span class="line">        at com.testerhome.appcrawler.Crawler.setupAppium(Crawler.scala:<span class="number">277</span>)</span><br><span class="line">        at com.testerhome.appcrawler.Crawler.restart(Crawler.scala:<span class="number">221</span>)</span><br><span class="line">        at com.testerhome.appcrawler.Crawler.crawl(Crawler.scala:<span class="number">201</span>)</span><br><span class="line">        at com.testerhome.appcrawler.Crawler.start(Crawler.scala:<span class="number">170</span>)</span><br><span class="line">        at com.testerhome.appcrawler.AppCrawler$.startCrawl(AppCrawler.scala:<span class="number">323</span>)</span><br><span class="line">        at com.testerhome.appcrawler.AppCrawler$.parseParams(AppCrawler.scala:<span class="number">291</span>)</span><br><span class="line">        at com.testerhome.appcrawler.AppCrawler$.main(AppCrawler.scala:<span class="number">91</span>)</span><br><span class="line">        at com.testerhome.appcrawler.AppCrawler.main(AppCrawler.scala)</span><br><span class="line">chengmingdeMacBook-Pro:AppCrawler cmlanche$</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[debug] [W3C (dd159942)] Encountered internal error running command: NoSuchDriverError: A session is either terminated or not started</span><br><span class="line">[debug] [W3C (dd159942)]     at asyncHandler (/usr/local/lib/node_modules/appium/node_modules/appium-base-driver/lib/protocol/protocol.js:298:15)</span><br><span class="line">[debug] [W3C (dd159942)]     at asyncHandler (/usr/local/lib/node_modules/appium/node_modules/appium-base-driver/lib/protocol/protocol.js:489:15)</span><br><span class="line">[debug] [W3C (dd159942)]     at Layer.handle [as handle_request] (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/layer.js:95:5)</span><br><span class="line">[debug] [W3C (dd159942)]     at next (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/route.js:137:13)</span><br><span class="line">[debug] [W3C (dd159942)]     at Route.dispatch (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/route.js:112:3)</span><br><span class="line">[debug] [W3C (dd159942)]     at Layer.handle [as handle_request] (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/layer.js:95:5)</span><br><span class="line">[debug] [W3C (dd159942)]     at /usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:281:22</span><br><span class="line">[debug] [W3C (dd159942)]     at param (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:354:14)</span><br><span class="line">[debug] [W3C (dd159942)]     at param (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:365:14)</span><br><span class="line">[debug] [W3C (dd159942)]     at Function.process_params (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:410:3)</span><br><span class="line">[debug] [W3C (dd159942)]     at next (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:275:10)</span><br><span class="line">[debug] [W3C (dd159942)]     at logger (/usr/local/lib/node_modules/appium/node_modules/morgan/index.js:144:5)</span><br><span class="line">[debug] [W3C (dd159942)]     at Layer.handle [as handle_request] (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/layer.js:95:5)</span><br><span class="line">[debug] [W3C (dd159942)]     at trim_prefix (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:317:13)</span><br><span class="line">[debug] [W3C (dd159942)]     at /usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:284:7</span><br><span class="line">[debug] [W3C (dd159942)]     at Function.process_params (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:335:12)</span><br><span class="line">[debug] [W3C (dd159942)]     at next (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:275:10)</span><br><span class="line">[debug] [W3C (dd159942)]     at jsonParser (/usr/local/lib/node_modules/appium/node_modules/body-parser/lib/types/json.js:110:7)</span><br><span class="line">[debug] [W3C (dd159942)]     at Layer.handle [as handle_request] (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/layer.js:95:5)</span><br><span class="line">[debug] [W3C (dd159942)]     at trim_prefix (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:317:13)</span><br><span class="line">[debug] [W3C (dd159942)]     at /usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:284:7</span><br><span class="line">[debug] [W3C (dd159942)]     at Function.process_params (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:335:12)</span><br><span class="line">[debug] [W3C (dd159942)]     at next (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:275:10)</span><br><span class="line">[debug] [W3C (dd159942)]     at Layer.handle [as handle_request] (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/layer.js:91:12)</span><br><span class="line">[debug] [W3C (dd159942)]     at trim_prefix (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:317:13)</span><br><span class="line">[debug] [W3C (dd159942)]     at /usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:284:7</span><br><span class="line">[debug] [W3C (dd159942)]     at Function.process_params (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:335:12)</span><br><span class="line">[debug] [W3C (dd159942)]     at next (/usr/local/lib/node_modules/appium/node_modules/express/lib/router/index.js:275:10)</span><br><span class="line">[HTTP] &lt;-- GET /wd/hub/session/dd159942-ed6d-411c-8dcc-b43d7fc26284/source 404 5 ms - 3173</span><br></pre></td></tr></table></figure><p>还是错的！</p><p>那就用我的最新java-client 7.0吧，重新执行一次完整的测试，发现没有任何问题！</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;思绪&quot;&gt;&lt;a href=&quot;#思绪&quot; class=&quot;headerlink&quot; title=&quot;思绪&quot;&gt;&lt;/a&gt;思绪&lt;/h3&gt;&lt;p&gt;最近完成了自定义Appium的需求，让Appium内置了自动识别权限框并点击的能力，参考我的知乎专栏：&lt;a href=&quot;https://zhuanlan.zhihu.com/custom-appium&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;自定义Appium之路&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;但遇到另外一个问题，就是testerhome思寒开发的AppiumCrawler并不支持Appium最新版，也就是当前的1.12版本，只支持到1.8版本，让人很是捉急。&lt;/p&gt;
&lt;p&gt;本来是想基于1.8重新自定义一个appium，但是发现这个appium实在太老了，下载下来编译都有各种问题，况且后续还要自定义appium-android-driver，appium-uiautomator2-driver和appium-uiaumator2-server，工作量至少得3天，太费时间。&lt;/p&gt;
&lt;p&gt;索性，我来替思寒把AppCrawler来升级一下，让它支持最新appium。&lt;/p&gt;
&lt;p&gt;刚开始觉得挺难的，毕竟我对scala只略知一二，编译打包方面还要学，但事后发现，这个工程做的确实不错，升级改造过程比预计的要简单很多，这里要给思寒大佬一个赞👍！&lt;/p&gt;
    
    </summary>
    
      <category term="Appium" scheme="http://www.cmlanche.com/categories/Appium/"/>
    
    
      <category term="appium" scheme="http://www.cmlanche.com/tags/appium/"/>
    
      <category term="appiumcrawler" scheme="http://www.cmlanche.com/tags/appiumcrawler/"/>
    
  </entry>
  
  <entry>
    <title>开源项目filepond的独立自由之路：城市套路深</title>
    <link href="http://www.cmlanche.com/2019/04/20/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AEfilepond%E7%9A%84%E7%8B%AC%E7%AB%8B%E8%87%AA%E7%94%B1%E4%B9%8B%E8%B7%AF%EF%BC%9A%E5%9F%8E%E5%B8%82%E5%A5%97%E8%B7%AF%E6%B7%B1/"/>
    <id>http://www.cmlanche.com/2019/04/20/开源项目filepond的独立自由之路：城市套路深/</id>
    <published>2019-04-20T01:19:41.000Z</published>
    <updated>2019-05-08T05:01:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>微信原文更清晰：<a href="https://mp.weixin.qq.com/s/dv39XvvDNlDqvSgrhN2f7A" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dv39XvvDNlDqvSgrhN2f7A</a></p><p>最近一直在做一个有关独立开发者友链联盟的插件项目，在做到上传头像时，满网络找最好的头像上传、剪裁插件，最后终于找到了<a href="https://github.com/pqina/filepond" target="_blank" rel="noopener">filepond</a>，满心欢喜的认为，这么好的东西居然是开源项目，简直牛的不要不要的。</p><a id="more"></a><p>这个filepond到底怎么好呢？给大家看俩图，或许能了解，她如此美丽简洁，真漂亮！</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/yeua9.gif" alt="filepond1"></p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/nuf1l.gif" alt="filepond2"></p><p>看到效果，是不是很激动？是不是特别想要？</p><p>想必肯定是了，我也是啊。</p><p>立马，我就开始准备继承她了。。。</p><p>集成中，才发现，filepond是一个设计也精美的插件，它由主filepond工程和几个不同功能的插件组成，你可以根据实际需求来添加插件，默认主工程可以直接使用，但只有基本的上传功能。插件如下：</p><ul><li><a href="https://github.com/pqina/filepond-plugin-file-encode" target="_blank" rel="noopener">File encode</a></li><li><a href="https://github.com/pqina/filepond-plugin-file-rename" target="_blank" rel="noopener">File rename</a></li><li><a href="https://github.com/pqina/filepond-plugin-file-validate-size" target="_blank" rel="noopener">File size validation</a></li><li><a href="https://github.com/pqina/filepond-plugin-file-validate-type" target="_blank" rel="noopener">File type validation</a></li><li><a href="https://github.com/pqina/filepond-plugin-file-metadata" target="_blank" rel="noopener">File metadata</a></li><li><a href="https://github.com/pqina/filepond-plugin-file-poster" target="_blank" rel="noopener">File poster</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-edit" target="_blank" rel="noopener">Image editor</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-validate-size" target="_blank" rel="noopener">Image size validation</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-preview" target="_blank" rel="noopener">Image preview</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-crop" target="_blank" rel="noopener">Image crop</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-resize" target="_blank" rel="noopener">Image resize</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-transform" target="_blank" rel="noopener">Image transform</a></li><li><a href="https://github.com/pqina/filepond-plugin-image-exif-orientation" target="_blank" rel="noopener">Image EXIF orientation</a></li></ul><p>并且作者pqina还适配了不同的前端框架：</p><ul><li><a href="https://github.com/pqina/react-filepond" target="_blank" rel="noopener">React</a></li><li><a href="https://github.com/pqina/vue-filepond" target="_blank" rel="noopener">Vue</a></li><li><a href="https://github.com/pqina/jquery-filepond" target="_blank" rel="noopener">jQuery</a></li><li><a href="https://github.com/pqina/ngx-filepond" target="_blank" rel="noopener">Angular</a></li><li><a href="https://github.com/johnnyasantoss/angularjs-filepond" target="_blank" rel="noopener">Angular 1</a></li><li><a href="https://github.com/alexdiliberto/ember-filepond" target="_blank" rel="noopener">Ember</a></li></ul><p>真的可以说是用心良苦啊！不得不佩服。</p><p>说这么多，只是说它有多牛逼，还没说到独立开发者上来，这个也是我集成filepond的图片编辑功能之后才了解到的，也就是上面中第二章图展示的功能。</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/xcvfb.png" alt="image-20190420094415203"></p><p>我擦，我好不容易把7个插件的js、css引入进来，结果还有个一Doka的东西！！这是什么鬼啊？？？</p><p>刚开始还以为是另外一个项目没引入，赶紧去filepond的README中找。。。最后找到这样几句话：</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/dv973.png" alt="image-20190420094620708"></p><p>打开Doka一看，原来TM是个收费项目啊，最牛逼最亮点的东西居然收费，我TM。。。。。服了，后来一转想，人家东西做的这么好，独立开发如此不容易，收个费怎么了，想到这，我就特想买了。</p><p>不过，人家价格方案比较贵，最低一年要79美金，而且不适用于saas，所以它这个项目，一开始就把目标人群定位在了企业级的用户上，很明确。</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/7knhz.png" alt="image-20190420095123231"></p><p>我是买不起你了，要是以后独立开发者友链联盟这个项目能做起来，做大了，我肯定买！</p><p>自此，我是深感套路深啊，但就算套路深，我却很喜欢这种感觉，毕竟人家很挣钱。</p><p>继续了解下背后的作者pqina吧，个人网站是：<a href="https://pqina.nl/" target="_blank" rel="noopener">pqina.nl</a>，个人网站上没有写任何有关自己的事情，基本都是自己的几个关键的独立产品，FilePond、Doka、Flip和Soon，但是公布的推特，当发现你很崇拜一个人的时候，你就特别想了解他的一切，那就fq去推特看看吧。</p><p>推特上显示他来自荷兰(Netherlands)，主要给WordPress、jQuery、React、Angular设计高质量的Web插件，并在推特上发布有趣的web相关的新闻。</p><p><strong>信息就这点，现在来复盘一下filepond的盈利模式。</strong></p><ol><li>创建开源项目filepond，开源绝大部分基础功能</li><li>在更高层次的图片编辑功能上做限制，开发出Doke.js的付费项目</li><li>filepond负责引流，filepond提供了很好的插件模式，虽然你也可能开发出类似的插件，但终究门槛太高，基本上如果你要图片编辑功能，那你是必须购买Doka.js的</li></ol><p>但，就是因为pgina把这块的功能做的足够好，并且市面上并没有比他更好的，所以才有这么大的自信做收费，还不便宜。</p><p><strong>对我们独立开发者的反思：</strong></p><ol><li>有时候我们并不需要做太多产品，做一款产品做到极致那抵得过”千军万马”</li><li>开源基础功能，高纬度功能收费，定价合理，这种盈利模式，独立开发者可以考虑一下</li><li>好的有价值的产品，能够做到自我传播，就像filepond一样，让我使劲夸它，要是一个烂东西，看都懒得看。所以独立开发者做的东西，一定要有很高的价值才行，一定不要敷衍你的用户！</li></ol><p>还有一点要分享就是关于谷歌搜索引擎，它的目标是让你找到对你最有价值的东西，只要你的东西做的够好，总会把这种价值带给用户，就像我找filepond，所以谷歌SEO不仅仅是字面的意思，还是背后一个价值的意思。</p><p><strong>关注我的订阅号：</strong></p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/op5uf.jpg" alt="qrcode_for_gh_2af76fcad768_258"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;微信原文更清晰：&lt;a href=&quot;https://mp.weixin.qq.com/s/dv39XvvDNlDqvSgrhN2f7A&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://mp.weixin.qq.com/s/dv39XvvDNlDqvSgrhN2f7A&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;最近一直在做一个有关独立开发者友链联盟的插件项目，在做到上传头像时，满网络找最好的头像上传、剪裁插件，最后终于找到了&lt;a href=&quot;https://github.com/pqina/filepond&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;filepond&lt;/a&gt;，满心欢喜的认为，这么好的东西居然是开源项目，简直牛的不要不要的。&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/tags/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="filepond" scheme="http://www.cmlanche.com/tags/filepond/"/>
    
  </entry>
  
  <entry>
    <title>centos7开放端口命令</title>
    <link href="http://www.cmlanche.com/2019/04/19/centos7%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3%E5%91%BD%E4%BB%A4/"/>
    <id>http://www.cmlanche.com/2019/04/19/centos7开放端口命令/</id>
    <published>2019-04-19T09:22:36.000Z</published>
    <updated>2019-05-14T08:52:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>亲测有效！</p><h3 id="centos查询端口是不是开放的"><a href="#centos查询端口是不是开放的" class="headerlink" title="centos查询端口是不是开放的"></a>centos查询端口是不是开放的</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">firewall-cmd --permanent --query-port=8080/tcp</span><br></pre></td></tr></table></figure><h3 id="添加对外开放端口"><a href="#添加对外开放端口" class="headerlink" title="添加对外开放端口"></a>添加对外开放端口</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">firewall-cmd --permanent --add-port=8080/tcp</span><br></pre></td></tr></table></figure><h3 id="重启防火墙"><a href="#重启防火墙" class="headerlink" title="重启防火墙"></a>重启防火墙</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;亲测有效！&lt;/p&gt;
&lt;h3 id=&quot;centos查询端口是不是开放的&quot;&gt;&lt;a href=&quot;#centos查询端口是不是开放的&quot; class=&quot;headerlink&quot; title=&quot;centos查询端口是不是开放的&quot;&gt;&lt;/a&gt;centos查询端口是不是开放的&lt;/h3&gt;&lt;fig
      
    
    </summary>
    
      <category term="日常技术" scheme="http://www.cmlanche.com/categories/%E6%97%A5%E5%B8%B8%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="centos7" scheme="http://www.cmlanche.com/tags/centos7/"/>
    
  </entry>
  
  <entry>
    <title>健康才是福，工作和生活的心态要平衡</title>
    <link href="http://www.cmlanche.com/2019/04/14/%E5%81%A5%E5%BA%B7%E6%89%8D%E6%98%AF%E7%A6%8F%EF%BC%8C%E5%B7%A5%E4%BD%9C%E5%92%8C%E7%94%9F%E6%B4%BB%E7%9A%84%E5%BF%83%E6%80%81%E8%A6%81%E5%B9%B3%E8%A1%A1/"/>
    <id>http://www.cmlanche.com/2019/04/14/健康才是福，工作和生活的心态要平衡/</id>
    <published>2019-04-14T13:02:44.000Z</published>
    <updated>2019-04-15T06:15:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天一早8点，肾结石突发，疼死我了，急忙跑到医院打针吃药，下午终于有点好转，感谢生命！但是基本上一坐下来就疼，只能站着。</p><a id="more"></a><p>可能很多人都有结石，体验结石带来的痛苦也有不少吧，那种疼痛感，很容易让人产生悲观厌世的感觉，终于不那么疼了，才想到，原来此前的每一刻那坐下来的舒适，都是幸福！</p><p>但是幸福如此在你身边，你却不以为意，感觉有无数的欲望和野心在等着你完成，马云说，能够996是种幸福，我说健康才是福，现在的每一刻每一秒都是幸福，工作是工作，生活是生活，都要有，而且要有滋有味，不要总是忙忙碌碌，不知所终。有野心没问题，但是切忌急躁，慢慢来。</p><p>工作和生活的心态要平衡，其实现在就是幸福，可以想太多，但不可以着急，不要给自己太大的压力。</p><p>鉴于结石的情况，给自己立几个规矩：</p><ol><li>晚上11点之前睡觉</li><li>少吃豆制品，少吃鸡蛋，多吃蔬菜</li><li>多喝水，多运动</li></ol><p>此文，你我诸君共勉！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天一早8点，肾结石突发，疼死我了，急忙跑到医院打针吃药，下午终于有点好转，感谢生命！但是基本上一坐下来就疼，只能站着。&lt;/p&gt;
    
    </summary>
    
      <category term="独立开发者" scheme="http://www.cmlanche.com/categories/%E7%8B%AC%E7%AB%8B%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
    
      <category term="生活" scheme="http://www.cmlanche.com/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>gradle构建appium-uiautomator2-server出现gradle版本不匹配</title>
    <link href="http://www.cmlanche.com/2019/04/12/gradle%E6%9E%84%E5%BB%BAappium-uiautomator2-server%E5%87%BA%E7%8E%B0gradle%E7%89%88%E6%9C%AC%E4%B8%8D%E5%8C%B9%E9%85%8D/"/>
    <id>http://www.cmlanche.com/2019/04/12/gradle构建appium-uiautomator2-server出现gradle版本不匹配/</id>
    <published>2019-04-12T04:31:31.000Z</published>
    <updated>2019-04-15T06:14:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>在克隆代码：<a href="https://github.com/appium/appium-uiautomator2-server" target="_blank" rel="noopener">appium-uiautomator2-server</a>后，按照说明文档README.md中所说，进行构建</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">gradle clean assembleE2ETestDebug assembleE2ETestDebugAndroidTest</span><br></pre></td></tr></table></figure><a id="more"></a><p>出现错误：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">FAILURE: Build failed with an exception.</span><br><span class="line"></span><br><span class="line">* Where:</span><br><span class="line">Build file '/Users/cmlanche/sourcetree/appium/appium-uiautomator2-server/app/build.gradle' line: 14</span><br><span class="line"></span><br><span class="line">* What went wrong:</span><br><span class="line">A problem occurred evaluating project ':app'.</span><br><span class="line"><span class="meta">&gt;</span> Failed to apply plugin [id 'com.android.application']</span><br><span class="line"><span class="meta">   &gt;</span> Minimum supported Gradle version is 4.10.1. Current version is 4.1. If using the gradle wrapper, try editing the distributionUrl in /Users/cmlanche/sourcetree/appium/appium-uiautomator2-server/gradle/wrapper/gradle-wrapper.properties to gradle-4.10.1-all.zip</span><br><span class="line"></span><br><span class="line">* Try:</span><br><span class="line">Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.</span><br><span class="line"></span><br><span class="line">* Get more help at https://help.gradle.org</span><br><span class="line"></span><br><span class="line">BUILD FAILED in 1s</span><br></pre></td></tr></table></figure><p>错误中说，当前工程最低要求的gradle版本是4.10.1，而当前的版本是4.1。</p><p>当时我并不知道，或者说已经忘记gradle是怎么安装的，索性做了两件事：</p><ol><li>使用<code>gradle -v</code>查询当前的版本号，确实显示的是4.1</li><li>使用brew upgrade gradle升级我的gradle，果不其然，我的gradle确实是用brew来管理的(各个系统不一样哈，我的是mac，不仅仅是可能操作系统的差异，也有可能是使用gradle也有差异，比如你可以用本地gradle来编译)</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chengmingdeMacBook-Pro:appium-uiautomator2-server cmlanche$ brew upgrade gradle</span><br><span class="line">Updating Homebrew...</span><br><span class="line">==&gt; Auto-updated Homebrew!</span><br><span class="line">Updated 2 taps (dart-lang/dart and homebrew/core).</span><br><span class="line">==&gt; New Formulae</span><br><span class="line">aliyun-cli         breezy             embree             frpc               frps               lazygit            ospray             volt               zabbix-cli</span><br><span class="line">==&gt; Updated Formulae</span><br><span class="line">go ✔                               direnv                             grafana                            mariadb                            simple-scan</span><br><span class="line">hugo ✔                             dita-ot                            gromacs                            maxwell                            smimesign</span><br><span class="line">swagger-codegen ✔                  django-completion                  groonga                            mesa                               snapcraft</span><br><span class="line">wget ✔                             dnscrypt-proxy                     gsoap                              meson                              snort</span><br><span class="line">ace                                docfx                              gssdp                              metabase                           sourcekitten</span><br><span class="line">algernon                           docker                             gtk+3                              micronaut                          sshguard</span><br><span class="line">ansible                            docker-completion                  gupnp                              mmseqs2                            ssllabs-scan</span><br><span class="line">anyenv                             docker-compose-completion          gupnp-av                           mps-youtube                        step</span><br><span class="line">apache-arrow                       docker-credential-helper-ecr       gupnp-tools                        nginx                              streamlink</span><br><span class="line">apache-arrow-glib                  doctl                              hadolint                           nsd                                stunnel</span><br><span class="line">apache-flink                       doitlive                           haproxy                            opam                               svgo</span><br><span class="line">apache-spark                       dynare                             hatari                             open-mpi                           swiftformat</span><br><span class="line">apr                                easyengine                         helmfile                           openjpeg                           syncthing</span><br><span class="line">asciidoctor                        embulk                             ispc                               openttd                            taskell</span><br><span class="line">asdf                               erlang                             istioctl                           pacapt                             tbb</span><br><span class="line">atlassian-cli                      ethereum                           jemalloc                           paket                              telegraf</span><br><span class="line">atomist-cli                        exploitdb                          jenkins                            pandoc                             terraform_landscape</span><br><span class="line">aws-okta                           faas-cli                           jenkins-lts                        pegtl                              tgui</span><br><span class="line">aws-sdk-cpp                        ffmpeg                             jfrog-cli-go                       php                                tippecanoe</span><br><span class="line">awscli                             file-roller                        jmeter                             php-code-sniffer                   tmux</span><br><span class="line">azure-cli                          fn                                 juju                               php@7.1                            topgrade</span><br><span class="line">binaryen                           fonttools                          kafkacat                           php@7.2                            ttfautohint</span><br><span class="line">bitrise                            freetds                            kitchen-sync                       phpunit                            typescript</span><br><span class="line">cake                               futhark                            krakend                            planck                             unbound</span><br><span class="line">carthage                           fx                                 kube-aws                           pmd                                ungit</span><br><span class="line">certbot                            gdcm                               kubecfg                            postgis                            v8</span><br><span class="line">cfssl                              get_iplayer                        ledger                             pre-commit                         vala</span><br><span class="line">cgal                               gitbucket                          libcroco                           prometheus                         vert.x</span><br><span class="line">checkstyle                         gitlab-runner                      libdazzle                          prototool                          vim</span><br><span class="line">citus                              gjs                                libnotify                          pulumi                             vte3</span><br><span class="line">cmark                              glib-networking                    libphonenumber                     putty                              wine</span><br><span class="line">collector-sidecar                  gmic                               librealsense                       pyenv                              wireguard-go</span><br><span class="line">composer                           gmsh                               libsoup                            rakudo-star                        wireguard-tools</span><br><span class="line">conan                              gnu-getopt                         libvirt                            riff                               xmake</span><br><span class="line">confluent-oss                      gnumeric                           libxlsxwriter                      rke                                yle-dl</span><br><span class="line">conjure-up                         gnunet                             links                              rtv                                youtube-dl</span><br><span class="line">cpprestsdk                         gnutls                             lmod                               ruby-build                         zabbix</span><br><span class="line">crowdin                            gobject-introspection              logtalk                            ruby@2.4                           zig</span><br><span class="line">cryfs                              gocr                               lolcat                             sbcl                               zim</span><br><span class="line">dcos-cli                           godep                              lumo                               sdl</span><br><span class="line">dhall                              gomplate                           lxc                                serverless</span><br><span class="line">dhall-json                         goreleaser                         mackup                             ship</span><br><span class="line">==&gt; Deleted Formulae</span><br><span class="line">pdftoedn                                                                                ruby@2.3</span><br><span class="line"></span><br><span class="line">==&gt; Upgrading 1 outdated package:</span><br><span class="line">gradle 4.1 -&gt; 5.3.1</span><br><span class="line">==&gt; Upgrading gradle </span><br><span class="line">==&gt; Downloading https://services.gradle.org/distributions/gradle-5.3.1-all.zip</span><br><span class="line">==&gt; Downloading from https://downloads.gradle.org/distributions/gradle-5.3.1-all.zip</span><br><span class="line"><span class="meta">#</span>####################################################################### 100.0%</span><br><span class="line">🍺  /usr/local/Cellar/gradle/5.3.1: 13,686 files, 236.8MB, built in 1 minute</span><br><span class="line">Removing: /usr/local/Cellar/gradle/4.1... (169 files, 71.7MB)</span><br></pre></td></tr></table></figure><p>升级完后，就可以正常使用<code>gradle</code>命令来打包了:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chengmingdeMacBook-Pro:appium-uiautomator2-server cmlanche$ gradle clean</span><br><span class="line"></span><br><span class="line">Welcome to Gradle 5.3.1!</span><br><span class="line"></span><br><span class="line">Here are the highlights of this release:</span><br><span class="line"> - Feature variants AKA "optional dependencies"</span><br><span class="line"> - Type-safe accessors in Kotlin precompiled script plugins</span><br><span class="line"> - Gradle Module Metadata 1.0</span><br><span class="line"></span><br><span class="line">For more details see https://docs.gradle.org/5.3.1/release-notes.html</span><br><span class="line"></span><br><span class="line">Starting a Gradle Daemon (subsequent builds will be faster)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span> Configure project :app</span><br><span class="line">NDK is missing a "platforms" directory.</span><br><span class="line">If you are using NDK, verify the ndk.dir is set to a valid NDK directory.  It is currently set to /Users/cmlanche/Library/Android/sdk/ndk-bundle.</span><br><span class="line">If you are not using NDK, unset the NDK variable from ANDROID_NDK_HOME or local.properties to remove this warning.</span><br><span class="line"></span><br><span class="line">WARNING: Configuration 'compile' is obsolete and has been replaced with 'implementation' and 'api'.</span><br><span class="line">It will be removed at the end of 2018. For more information see: http://d.android.com/r/tools/update-dependency-configurations.html</span><br><span class="line"></span><br><span class="line">Deprecated Gradle features were used in this build, making it incompatible with Gradle 6.0.</span><br><span class="line">Use '--warning-mode all' to show the individual deprecation warnings.</span><br><span class="line">See https://docs.gradle.org/5.3.1/userguide/command_line_interface.html#sec:command_line_warnings</span><br><span class="line"></span><br><span class="line">BUILD SUCCESSFUL in 1m 3s</span><br><span class="line">2 actionable tasks: 2 executed</span><br></pre></td></tr></table></figure><p>其实，并不是gradle这个版本不能用，而是对<code>appium-uiautomator2-server</code>这个工程不能拿用，因为gradle版本和谷歌的<code>com.android.tools.build:gradle</code>插件是有个对应关系的，这个server工程中使用的是3.3.2,其最小的gradle就是4.10.1，对应关系链接: <a href="https://developer.android.google.cn/studio/releases/gradle-plugin.html#updating-gradle" target="_blank" rel="noopener">https://developer.android.google.cn/studio/releases/gradle-plugin.html#updating-gradle</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在克隆代码：&lt;a href=&quot;https://github.com/appium/appium-uiautomator2-server&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;appium-uiautomator2-server&lt;/a&gt;后，按照说明文档README.md中所说，进行构建&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gradle clean assembleE2ETestDebug assembleE2ETestDebugAndroidTest&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Appium" scheme="http://www.cmlanche.com/categories/Appium/"/>
    
    
      <category term="appium" scheme="http://www.cmlanche.com/tags/appium/"/>
    
      <category term="uiautomator2" scheme="http://www.cmlanche.com/tags/uiautomator2/"/>
    
      <category term="appium-uiautomator2-server" scheme="http://www.cmlanche.com/tags/appium-uiautomator2-server/"/>
    
  </entry>
  
  <entry>
    <title>给Appium内置系统对话框自动处理 - appium-uiautomator2-driver篇</title>
    <link href="http://www.cmlanche.com/2019/04/11/%E7%BB%99Appium%E5%86%85%E7%BD%AE%E7%B3%BB%E7%BB%9F%E5%AF%B9%E8%AF%9D%E6%A1%86%E8%87%AA%E5%8A%A8%E5%A4%84%E7%90%86---appium-uiautomator2-driver%E7%AF%87/"/>
    <id>http://www.cmlanche.com/2019/04/11/给Appium内置系统对话框自动处理---appium-uiautomator2-driver篇/</id>
    <published>2019-04-11T09:02:20.000Z</published>
    <updated>2019-04-15T06:15:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>欢迎关注我的Appium知乎专栏：<a href="https://zhuanlan.zhihu.com/custom-appium" target="_blank" rel="noopener">自定义Appium之路</a></p><p>当appium脚本的uiautomationName设置为UiAutomator2时，就会启动appium-uiautomator2-driver这个driver来执行你的脚本测试，而它的系统对话框的处理跟UIAutomator1的就不一样了，更加复杂一点。</p><p>因为UIAutomator2是一个apk形式的，本身可以认为是一个应用，是需要安装的，所以在启动UIAutomator2之前，就会碰到系统对话框的问题，此时，我们需要借助UIAutomator1来做这件事。</p><a id="more"></a><h3 id="大体流程是："><a href="#大体流程是：" class="headerlink" title="大体流程是："></a>大体流程是：</h3><ol><li>启动UIAutomator1</li><li>用UIAutomator1来处理权限框</li><li>安装各种apk，包括UIAutomator2的apk</li><li>杀死UIAutomator1服务</li><li>启动UIAutomator2</li><li>使用UIAutomator2来监控界面，处理系统对话框</li></ol><h3 id="怎么做呢？"><a href="#怎么做呢？" class="headerlink" title="怎么做呢？"></a>怎么做呢？</h3><p>首先我们需要修改appium-uiautomator2-driver，因为原本的执行流程根本没有UIAutomator1的事情，我们需要把UIAutomator1引用进来：(appium-uiautomator2-driver/lib/driver.js)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; androidHelpers, androidCommands, SETTINGS_HELPER_PKG_ID, UiAutomator &#125; <span class="keyword">from</span> <span class="string">'appium-android-driver-cmext'</span>;</span><br></pre></td></tr></table></figure><p>上面代码中的UiAutomator是我新加的，但是在appium-android-driver中并没有导出UiAutomator的，我们需要给它导出来：(在appium-uiautomator2-driver/index.js)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> driver <span class="keyword">from</span> <span class="string">'./lib/driver'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> androidHelperIndex <span class="keyword">from</span> <span class="string">'./lib/android-helpers'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> commandIndex <span class="keyword">from</span> <span class="string">'./lib/commands/index'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> webview <span class="keyword">from</span> <span class="string">'./lib/webview-helpers'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> caps <span class="keyword">from</span> <span class="string">'./lib/desired-caps'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> uia <span class="keyword">from</span> <span class="string">'./lib/uiautomator'</span>;   <span class="comment">// 这是新增</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; AndroidDriver &#125; = driver;</span><br><span class="line"><span class="keyword">const</span> &#123; UiAutomator &#125; = uia; <span class="comment">// 这是新增</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">helpers</span>: webviewHelpers, NATIVE_WIN, WEBVIEW_WIN, WEBVIEW_BASE,</span><br><span class="line">        CHROMIUM_WIN &#125; = webview;</span><br><span class="line"><span class="keyword">const</span> &#123; commonCapConstraints &#125; = caps;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">commands</span>: androidCommands &#125; = commandIndex;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">helpers</span>: androidHelpers, SETTINGS_HELPER_PKG_ID &#125; = androidHelperIndex;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> AndroidDriver;</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  androidHelpers, androidCommands, AndroidDriver, startServer,</span><br><span class="line">  commonCapConstraints, webviewHelpers, NATIVE_WIN, WEBVIEW_WIN,</span><br><span class="line">  WEBVIEW_BASE, CHROMIUM_WIN, SETTINGS_HELPER_PKG_ID, UiAutomator <span class="comment">// 这是新增</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>添加一个启动UIAutomator1服务的方法：(appium-uiautomator2-driver/lib/driver.js)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">async</span> startUiAutomator1Service () &#123;</span><br><span class="line">  <span class="keyword">const</span> rootDir = path.resolve(__dirname, <span class="string">'..'</span>, <span class="string">'..'</span>, <span class="string">'..'</span>, <span class="string">'appium-android-driver'</span>);</span><br><span class="line">  <span class="keyword">const</span> startDetector = <span class="function">(<span class="params">s</span>) =&gt;</span> &#123; <span class="keyword">return</span> <span class="regexp">/Appium Socket Server Ready/</span>.test(s); &#125;;</span><br><span class="line">  <span class="keyword">const</span> bootstrapJar = path.resolve(rootDir, <span class="string">'bootstrap'</span>, <span class="string">'bin'</span>, <span class="string">'AppiumBootstrap.jar'</span>);</span><br><span class="line">  <span class="keyword">this</span>.uiAutomator = <span class="keyword">new</span> UiAutomator(<span class="keyword">this</span>.adb);</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">this</span>.uiAutomator.start(</span><br><span class="line">    bootstrapJar, <span class="string">'io.appium.android.bootstrap.Bootstrap'</span>,</span><br><span class="line">    startDetector);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为这个driver.js没有导入path，我们还要导入path：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">'path'</span>;</span><br></pre></td></tr></table></figure><p>然后我们找到<code>startUiAutomator2Session</code>方法，分别添加如下代码：</p><ol><li><p>启动UIAutomator1的代码：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 启动UIAutomator2之前，先启动UIAutomator1服务来处理系统框</span></span><br><span class="line"><span class="keyword">await</span> <span class="keyword">this</span>.startUiAutomator1Service();</span><br></pre></td></tr></table></figure></li><li><p>kill UIAutomator1的代码：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在启动UIAutomator2之前，要先杀死UIAutomator1服务，否则UIAutomator2无法启动</span></span><br><span class="line"><span class="comment">// 因为UIAutomator只允许同时存在一个</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.uiAutomator) &#123;</span><br><span class="line"><span class="keyword">this</span>.uiAutomator.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>位置如下图：</p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/awqkh.png" alt="image-20190411171620414"></p><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/2am2t.png" alt="image-20190411171642533"></p><p>自此，nodejs的事情就完成了，剩下的就是要改造appium-uiautomator2-server的代码，让它能够像UIAutomator1一样监听界面，自动处理。</p><h3 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h3><p>过程：</p><ol><li>本地启动appium</li><li>执行appium脚本测试</li><li>logcat展示监控过程</li></ol><p><img src="https://cmlanche-1251406926.cos.ap-guangzhou.myqcloud.com/blog/ey7js.gif" alt="appium-auto"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;欢迎关注我的Appium知乎专栏：&lt;a href=&quot;https://zhuanlan.zhihu.com/custom-appium&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;自定义Appium之路&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;当appium脚本的uiautomationName设置为UiAutomator2时，就会启动appium-uiautomator2-driver这个driver来执行你的脚本测试，而它的系统对话框的处理跟UIAutomator1的就不一样了，更加复杂一点。&lt;/p&gt;
&lt;p&gt;因为UIAutomator2是一个apk形式的，本身可以认为是一个应用，是需要安装的，所以在启动UIAutomator2之前，就会碰到系统对话框的问题，此时，我们需要借助UIAutomator1来做这件事。&lt;/p&gt;
    
    </summary>
    
      <category term="Appium" scheme="http://www.cmlanche.com/categories/Appium/"/>
    
    
      <category term="appium" scheme="http://www.cmlanche.com/tags/appium/"/>
    
  </entry>
  
</feed>
